<!DOCTYPE html>
<html>
<head>
  <meta name="databricks-html-version" content="1">
<title>fyp - Databricks</title>

<meta charset="utf-8">
<meta name="google" content="notranslate">
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Type" content="text/html; charset=UTF8">
<link rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700">

<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/lib/jquery-ui-bundle/jquery-ui.min.css">
<link rel="stylesheet" type="text/css" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/main.css">
<link rel="stylesheet" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/css/print.css" media="print">
<link rel="icon" type="image/png" href="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/img/favicon.ico"/>
<script>window.settings = {"enableSshKeyUI":true,"enableAutoCompleteAsYouType":[],"devTierName":"Community Edition","workspaceFeaturedLinks":[{"linkURI":"https://docs.databricks.com/index.html","displayName":"Documentation","icon":"question"},{"linkURI":"https://docs.databricks.com/release-notes/product/latest.html","displayName":"Release Notes","icon":"code"},{"linkURI":"https://docs.databricks.com/spark/latest/training/index.html","displayName":"Training & Tutorials","icon":"graduation-cap"}],"enableClearStateFeature":false,"dbcForumURL":"http://forums.databricks.com/","maxCustomTags":45,"enableInstanceProfilesUIInJobs":true,"nodeInfo":{"node_types":[{"spark_heap_memory":4800,"instance_type_id":"r3.2xlarge","spark_core_oversubscription_factor":8.0,"node_type_id":"dev-tier-node","description":"Community Optimized","support_cluster_tags":false,"container_memory_mb":6000,"memory_mb":6144,"category":"Community Edition","num_cores":0.88,"support_ebs_volumes":false}],"default_node_type_id":"dev-tier-node"},"enableThirdPartyApplicationsUI":false,"enableClusterAcls":true,"notebookRevisionVisibilityHorizon":999999,"enableTableHandler":true,"maxEbsVolumesPerInstance":10,"isAdmin":true,"deltaProcessingBatchSize":1000,"enableLargeResultDownload":true,"zoneInfos":[{"id":"us-west-2c","isDefault":true},{"id":"us-west-2b","isDefault":false},{"id":"us-west-2a","isDefault":false}],"enableEBSVolumesUIForJobs":true,"enablePublishNotebooks":true,"enableMaxConcurrentRuns":true,"enableJobAclsConfig":false,"enableFullTextSearch":false,"enableElasticSparkUI":false,"enableNewClustersCreate":false,"clusters":true,"allowRunOnPendingClusters":true,"applications":false,"fileStoreBase":"FileStore","enableSshKeyUIInJobs":true,"enableDetachAndAttachSubMenu":false,"configurableSparkOptionsSpec":[{"keyPattern":"spark\\.kryo(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.kryo.*","valuePatternDisplay":"*","description":"Configuration options for Kryo serialization"},{"keyPattern":"spark\\.io\\.compression\\.codec","valuePattern":"(lzf|snappy|org\\.apache\\.spark\\.io\\.LZFCompressionCodec|org\\.apache\\.spark\\.io\\.SnappyCompressionCodec)","keyPatternDisplay":"spark.io.compression.codec","valuePatternDisplay":"snappy|lzf","description":"The codec used to compress internal data such as RDD partitions, broadcast variables and shuffle outputs."},{"keyPattern":"spark\\.serializer","valuePattern":"(org\\.apache\\.spark\\.serializer\\.JavaSerializer|org\\.apache\\.spark\\.serializer\\.KryoSerializer)","keyPatternDisplay":"spark.serializer","valuePatternDisplay":"org.apache.spark.serializer.JavaSerializer|org.apache.spark.serializer.KryoSerializer","description":"Class to use for serializing objects that will be sent over the network or need to be cached in serialized form."},{"keyPattern":"spark\\.rdd\\.compress","valuePattern":"(true|false)","keyPatternDisplay":"spark.rdd.compress","valuePatternDisplay":"true|false","description":"Whether to compress serialized RDD partitions (e.g. for StorageLevel.MEMORY_ONLY_SER). Can save substantial space at the cost of some extra CPU time."},{"keyPattern":"spark\\.speculation","valuePattern":"(true|false)","keyPatternDisplay":"spark.speculation","valuePatternDisplay":"true|false","description":"Whether to use speculation (recommended off for streaming)"},{"keyPattern":"spark\\.es(\\.[^\\.]+)+","valuePattern":".*","keyPatternDisplay":"spark.es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"es(\\.([^\\.]+))+","valuePattern":".*","keyPatternDisplay":"es.*","valuePatternDisplay":"*","description":"Configuration options for ElasticSearch"},{"keyPattern":"spark\\.(storage|shuffle)\\.memoryFraction","valuePattern":"0?\\.0*([1-9])([0-9])*","keyPatternDisplay":"spark.(storage|shuffle).memoryFraction","valuePatternDisplay":"(0.0,1.0)","description":"Fraction of Java heap to use for Spark's shuffle or storage"},{"keyPattern":"spark\\.streaming\\.backpressure\\.enabled","valuePattern":"(true|false)","keyPatternDisplay":"spark.streaming.backpressure.enabled","valuePatternDisplay":"true|false","description":"Enables or disables Spark Streaming's internal backpressure mechanism (since 1.5). This enables the Spark Streaming to control the receiving rate based on the current batch scheduling delays and processing times so that the system receives only as fast as the system can process. Internally, this dynamically sets the maximum receiving rate of receivers. This rate is upper bounded by the values `spark.streaming.receiver.maxRate` and `spark.streaming.kafka.maxRatePerPartition` if they are set."},{"keyPattern":"spark\\.streaming\\.receiver\\.maxRate","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.receiver.maxRate","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which each receiver will receive data. Effectively, each stream will consume at most this number of records per second. Setting this configuration to 0 or a negative number will put no limit on the rate. See the deployment guide in the Spark Streaming programing guide for mode details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRatePerPartition","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRatePerPartition","valuePatternDisplay":"numeric","description":"Maximum rate (number of records per second) at which data will be read from each Kafka partition when using the Kafka direct stream API introduced in Spark 1.3. See the Kafka Integration guide for more details."},{"keyPattern":"spark\\.streaming\\.kafka\\.maxRetries","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.kafka.maxRetries","valuePatternDisplay":"numeric","description":"Maximum number of consecutive retries the driver will make in order to find the latest offsets on the leader of each partition (a default value of 1 means that the driver will make a maximum of 2 attempts). Only applies to the Kafka direct stream API introduced in Spark 1.3."},{"keyPattern":"spark\\.streaming\\.ui\\.retainedBatches","valuePattern":"^([0-9]{1,})$","keyPatternDisplay":"spark.streaming.ui.retainedBatches","valuePatternDisplay":"numeric","description":"How many batches the Spark Streaming UI and status APIs remember before garbage collecting."}],"enableReactNotebookComments":true,"enableAdminPasswordReset":false,"enableResetPassword":true,"maxClusterTagValueLength":255,"enableJobsSparkUpgrade":true,"sparkVersions":[{"key":"1.6.x-ubuntu15.10","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.4.x-ubuntu15.10","displayName":"Spark 1.4.1 (Hadoop 1)","packageLabel":"spark-image-f710650fb8aaade8e4e812368ea87c45cd8cd0b5e6894ca6c94f3354e8daa6dc","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.0-ubuntu15.10-scala2.10","displayName":"Spark 2.0.0 (Scala 2.10)","packageLabel":"spark-image-073c1b52ace74f251fae2680624a0d8d184a8b57096d1c21c5ce56c29be6a37a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.11","displayName":"Spark 2.1.0 RC5 (Scala 2.11)","packageLabel":"spark-image-20833506f690f3a49c53fb08837cb9b98f7f2e15380f1fb26efc158d953e94c8","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop1","displayName":"Spark 1.6.x (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"1.6.1-ubuntu15.10-hadoop1","displayName":"Spark 1.6.1 (Hadoop 1)","packageLabel":"spark-image-21d1cac181b7b8856dd1b4214a3a734f95b5289089349db9d9c926cb87d843db","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-gpu-scala2.11","displayName":"Spark 2.0 (Auto-updating, GPU, Scala 2.11 experimental)","packageLabel":"spark-image-6c2dd678fff350c03ba0e945bab52d0080cd857a39c99a22131b3e824bb8096f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop1","displayName":"Spark 1.6.2 (Hadoop 1)","packageLabel":"spark-image-8cea23fb9094e174bf5815d79009f4a8e383eb86cf2909cf6c6434ed8da2a16a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop2-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 2, Scala 2.10)","packageLabel":"spark-image-eaa8d9b990015a14e032fb2e2e15be0b8d5af9627cd01d855df728b67969d5d9","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.2-ubuntu15.10-hadoop2","displayName":"Spark 1.6.2 (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.1-ubuntu15.10-hadoop2","displayName":"Spark 1.6.1 (Hadoop 2)","packageLabel":"spark-image-4cafdf8bc6cba8edad12f441e3b3f0a8ea27da35c896bc8290e16b41fd15496a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.10","displayName":"Spark 2.0.2-db2 (Scala 2.10)","packageLabel":"spark-image-36d48f22cca7a907538e07df71847dd22aaf84a852c2eeea2dcefe24c681602f","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10-scala2.11","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.11, deprecated)","packageLabel":"spark-image-8e1c50d626a52eac5a6c8129e09ae206ba9890f4523775f77af4ad6d99a64c44","upgradable":true,"deprecated":true,"customerVisible":true},{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-4f22a8d3016bc3dce9e839b10418815a7d28afff3a027b43bd2b041c42b2a89d","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.11","displayName":"Spark 2.0.2-db1 (Scala 2.11)","packageLabel":"spark-image-c2d623f03dd44097493c01aa54a941fc31978ebe6d759b36c75b716b2ff6ab9c","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.5.x-ubuntu15.10","displayName":"Spark 1.5.2 (Hadoop 1)","packageLabel":"spark-image-c9d2a8abf41f157a4acc6d52bc721090346f6fea2de356f3a66e388f54481698","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-scala2.11","displayName":"Spark 2.0 (Auto-updating, Scala 2.11)","packageLabel":"spark-image-596490ba3e0ca4b62abb048923fc70de84e319cf527bb7a5a8f609bbf780bed8","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db2-scala2.11","displayName":"Spark 2.0.2-db2 (Scala 2.11)","packageLabel":"spark-image-4fa852ba378e97815083b96c9cada7b962a513ec23554a5fc849f7f1dd8c065a","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.3.x-ubuntu15.10","displayName":"Spark 1.3.0 (Hadoop 1)","packageLabel":"spark-image-40d2842670bc3dc178b14042501847d76171437ccf70613fa397a7a24c48b912","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.1-db1-scala2.11","displayName":"Spark 2.0.1-db1 (Scala 2.11)","packageLabel":"spark-image-10ab19f634bbfdb860446c326a9f76dc25bfa87de6403b980566279142a289ea","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.3-db1-hadoop1-scala2.10","displayName":"Spark 1.6.3-db1 (Hadoop 1, Scala 2.10)","packageLabel":"spark-image-d50af1032799546b8ccbeeb76889a20c819ebc2a0e68ea20920cb30d3895d3ae","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.2-db1-scala2.10","displayName":"Spark 2.0.2-db1 (Scala 2.10)","packageLabel":"spark-image-654bdd6e9bad70079491987d853b4b7abf3b736fff099701501acaabe0e75c41","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.0.x-ubuntu15.10","displayName":"Spark 2.0 (Ubuntu 15.10, Scala 2.10, deprecated)","packageLabel":"spark-image-a659f3909d51b38d297b20532fc807ecf708cfb7440ce9b090c406ab0c1e4b7e","upgradable":true,"deprecated":true,"customerVisible":true},{"key":"2.0.1-db1-scala2.10","displayName":"Spark 2.0.1-db1 (Scala 2.10)","packageLabel":"spark-image-5a13c2db3091986a4e7363006cc185c5b1108c7761ef5d0218506cf2e6643840","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"2.1.0-db1-scala2.10","displayName":"Spark 2.1.0 RC5 (Scala 2.10)","packageLabel":"spark-image-f430b652793cbc27e454dc629737ae2bc04b75a1fecd68a5d90c44eca7543756","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.0-ubuntu15.10","displayName":"Spark 1.6.0 (Hadoop 1)","packageLabel":"spark-image-10ef758029b8c7e19cd7f4fb52fff9180d75db92ca071bd94c47f3c1171a7cb5","upgradable":true,"deprecated":false,"customerVisible":true},{"key":"1.6.x-ubuntu15.10-hadoop2","displayName":"Spark 1.6.x (Hadoop 2)","packageLabel":"spark-image-161245e66d887cd775e23286a54bab0b146143e1289f25bd1732beac454a1561","upgradable":true,"deprecated":false,"customerVisible":false},{"key":"2.0.0-ubuntu15.10-scala2.11","displayName":"Spark 2.0.0 (Scala 2.11)","packageLabel":"spark-image-b4ec141e751f201399f8358a82efee202560f7ed05e1a04a2ae8778f6324b909","upgradable":true,"deprecated":false,"customerVisible":true}],"enableRestrictedClusterCreation":true,"enableFeedback":true,"enableClusterAutoScaling":false,"enableUserVisibleDefaultTags":false,"defaultNumWorkers":0,"serverContinuationTimeoutMillis":10000,"driverStderrFilePrefix":"stderr","enableNotebookRefresh":false,"accountsOwnerUrl":"https://accounts.cloud.databricks.com/registration.html#login","driverStdoutFilePrefix":"stdout","defaultNodeTypeToPricingUnitsMap":{"r3.2xlarge":2,"class-node":1,"p2.8xlarge":16,"r3.8xlarge":8,"dev-tier-node":1,"c3.8xlarge":4,"r3.4xlarge":4,"i2.4xlarge":6,"development-node":1,"i2.2xlarge":3,"g2.8xlarge":6,"memory-optimized":1,"p2.16xlarge":24,"c3.2xlarge":1,"c4.2xlarge":1,"i2.xlarge":1.5,"compute-optimized":1,"c4.4xlarge":2,"c3.4xlarge":2,"g2.2xlarge":1.5,"p2.xlarge":2,"c4.8xlarge":4,"r3.xlarge":1,"i2.8xlarge":12},"enableSparkDocsSearch":true,"sparkHistoryServerEnabled":true,"enableEBSVolumesUI":false,"sanitizeMarkdownHtml":true,"enableIPythonImportExport":true,"enableClusterTagsUIForJobs":false,"enableClusterTagsUI":false,"enableNotebookHistoryDiffing":true,"branch":"2.34","accountsLimit":3,"enableX509Authentication":false,"enableNotebookGitBranching":true,"local":false,"enableClusterAutoScalingForJobs":false,"enableStrongPassword":false,"displayDefaultContainerMemoryGB":6,"disableS3TableImport":false,"deploymentMode":"production","useSpotForWorkers":true,"enableUserInviteWorkflow":true,"enableStaticNotebooks":true,"enableCssTransitions":true,"minClusterTagKeyLength":1,"showHomepageFeaturedLinks":true,"pricingURL":"https://databricks.com/product/pricing","enableClusterAclsConfig":false,"useTempS3UrlForTableUpload":false,"notifyLastLogin":false,"enableNotebookGitVersioning":true,"files":"files/","feedbackEmail":"feedback@databricks.com","enableDriverLogsUI":true,"disableLegacyDashboards":true,"enableWorkspaceAclsConfig":false,"dropzoneMaxFileSize":4096,"enableNewClustersList":false,"enableNewDashboardViews":true,"driverLog4jFilePrefix":"log4j","enableSingleSignOn":true,"enableMavenLibraries":true,"displayRowLimit":1000,"deltaProcessingAsyncEnabled":true,"defaultSparkVersion":{"key":"2.0.x-scala2.10","displayName":"Spark 2.0 (Auto-updating, Scala 2.10)","packageLabel":"spark-image-4f22a8d3016bc3dce9e839b10418815a7d28afff3a027b43bd2b041c42b2a89d","upgradable":true,"deprecated":false,"customerVisible":true},"enableCustomSpotPricing":true,"enableMountAclsConfig":false,"useDevTierHomePage":true,"enablePublishHub":false,"notebookHubUrl":"http://hub.dev.databricks.com/","showSqlEndpoints":false,"enableClusterAclsByTier":false,"databricksDocsBaseUrl":"https://docs.databricks.com/","disallowAddingAdmins":true,"enableSparkConfUI":true,"featureTier":"DEVELOPER_BASIC_TIER","enableOrgSwitcherUI":true,"clustersLimit":1,"enableJdbcImport":true,"logfiles":"logfiles/","enableWebappSharding":true,"enableClusterDeltaUpdates":true,"enableSingleSignOnLogin":false,"staticNotebookDashboardId":4486708019551211,"ebsVolumeSizeLimitGB":{"GENERAL_PURPOSE_SSD":[100,4096],"THROUGHPUT_OPTIMIZED_HDD":[500,4096]},"enableMountAcls":false,"requireEmailUserName":true,"enableDashboardViews":false,"dbcFeedbackURL":"mailto:feedback@databricks.com","enableMountAclService":true,"enableWorkspaceAcls":false,"maxClusterTagKeyLength":127,"gitHash":"bcda81cf895a136c83055406bb2c4fd701411084-dirty","showWorkspaceFeaturedLinks":true,"signupUrl":"https://databricks.com/try-databricks","allowFeedbackForumAccess":true,"enableImportFromUrl":true,"enableMiniClusters":true,"enableDebugUI":false,"allowNonAdminUsers":true,"enableSingleSignOnByTier":false,"enableJobsRetryOnTimeout":true,"staticNotebookResourceUrl":"https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/","enableSparkPackages":true,"dynamicSparkVersions":true,"enableNotebookHistoryUI":true,"showDebugCounters":false,"enableInstanceProfilesUI":true,"enableFolderHtmlExport":true,"enableSparkVersionsUI":true,"homepageFeaturedLinks":[{"linkURI":"https://docs.databricks.com/_static/notebooks/gentle-introduction-to-apache-spark.html","displayName":"Introduction to Apache Spark on Databricks","icon":"img/home/Python_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/databricks-for-data-scientists.html","displayName":"Databricks for Data Scientists","icon":"img/home/Scala_icon.svg"},{"linkURI":"https://docs.databricks.com/_static/notebooks/structured-streaming-python.html","displayName":"Introduction to Structured Streaming","icon":"img/home/Python_icon.svg"}],"upgradeURL":"https://accounts.cloud.databricks.com/registration.html#login","notebookLoadingBackground":"#fff","sshContainerForwardedPort":2200,"enableServerAutoComplete":true,"enableStaticHtmlImport":true,"enableInstanceProfilesByTier":false,"enableTerminal":false,"defaultMemoryPerContainerMB":6000,"enablePresenceUI":true,"accounts":true,"useFramedStaticNotebooks":false,"enableNewProgressReportUI":true,"defaultCoresPerContainer":4,"enableNewClustersGet":false,"showSqlProxyUI":true};</script>
<script>var __DATABRICKS_NOTEBOOK_MODEL = {"version":"NotebookV1","origId":1363072632225895,"name":"fyp","language":"python","commands":[{"version":"CommandV1","origId":4047260936920674,"guid":"d93eccf9-3955-4d4b-aa7d-4042bc8894cd","subtype":"command","commandType":"auto","position":0.5,"command":"%md ![spark](http://spark.apache.org/images/spark-logo-trademark.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.480495730829E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"47e949ac-ae4f-4048-a9af-e77d0c9156cb"},{"version":"CommandV1","origId":996009626413042,"guid":"3c644587-9054-4461-9a56-3073d11fd0a5","subtype":"command","commandType":"auto","position":1.0,"command":"\n#ACCESSY_KEY_ID = \"AKIAIYT6K33CS2UU63QA\"\n#SECERET_ACCESS_KEY = \"4u4NirlSmzBmFBu8iqU27+MnfDN70jT/aH++O+Ee\" \n\n#mounts_list = [\n#{'bucket':'dannyfyp', 'mount_folder':'/mnt/apacheLog'}\n#]\n\n# Setup AWS configuration\nimport urllib\nACCESS_KEY = \"AKIAIYT6K33CS2UU63QA\"\nSECRET_KEY = \"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\"\nENCODED_SECRET_KEY = urllib.quote(SECRET_KEY, \"\")\nAWS_BUCKET_NAME = \"dannyfyp\"\nMOUNT_NAME = \"apacheLogs\"\n\n\n# Mount S3 bucket\ntry:\n  dbutils.fs.mount(\"s3n://%s:%s@%s/\" % (ACCESS_KEY, ENCODED_SECRET_KEY, AWS_BUCKET_NAME), \"/mnt/%s\" % MOUNT_NAME)\n  #dbutils.fs.unmount(\"/mnt/apacheLogs\")\n  \nexcept Exception:\n  pass\n\n\n\n\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Internal error, sorry. Attach your notebook to a different cluster or restart the current cluster.","error":"java.net.ConnectException: Connection refused\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)\n\tat sun.nio.ch.SocketAdaptor.connect(SocketAdaptor.java:111)\n\tat org.eclipse.jetty8.client.SelectConnector.startConnection(SelectConnector.java:79)\n\tat org.eclipse.jetty8.client.HttpDestination.startNewConnection(HttpDestination.java:283)\n\tat org.eclipse.jetty8.client.HttpDestination.doSend(HttpDestination.java:575)\n\tat org.eclipse.jetty8.client.HttpDestination.send(HttpDestination.java:513)\n\tat org.eclipse.jetty8.client.HttpClient.send(HttpClient.java:164)\n\tat com.databricks.rpc.JettyClient$$anonfun$sendRawExchange$1.apply$mcV$sp(JettyClient.scala:258)\n\tat com.databricks.rpc.JettyClient$$anonfun$sendRawExchange$1.apply(JettyClient.scala:248)\n\tat com.databricks.rpc.JettyClient$$anonfun$sendRawExchange$1.apply(JettyClient.scala:248)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:145)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:140)\n\tat com.databricks.rpc.JettyClient.withAttributionContext(JettyClient.scala:31)\n\tat com.databricks.rpc.JettyClient.sendRawExchange(JettyClient.scala:248)\n\tat com.databricks.rpc.JettyClient.sendExchange(JettyClient.scala:160)\n\tat com.databricks.rpc.JettyClient.sendAsync(JettyClient.scala:98)\n\tat com.databricks.rpc.BoundRPCClient.sendAsync(BoundRPCClient.scala:43)\n\tat com.databricks.backend.daemon.driver.DriverClient.com$databricks$backend$daemon$driver$DriverClient$$send(DriverClient.scala:78)\n\tat com.databricks.backend.daemon.driver.DriverClient$$anonfun$3.apply(DriverClient.scala:243)\n\tat com.databricks.backend.daemon.driver.DriverClient$$anonfun$3.apply(DriverClient.scala:243)\n\tat com.databricks.util.FutureUtils$.retry(FutureUtils.scala:89)\n\tat com.databricks.util.FutureUtils$$anonfun$retry$1.applyOrElse(FutureUtils.scala:93)\n\tat com.databricks.util.FutureUtils$$anonfun$retry$1.applyOrElse(FutureUtils.scala:91)\n\tat scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:344)\n\tat scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:343)\n\tat scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1$$anonfun$run$1.apply$mcV$sp(NamedExecutor.scala:238)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1$$anonfun$run$1.apply(NamedExecutor.scala:238)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1$$anonfun$run$1.apply(NamedExecutor.scala:238)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:145)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:140)\n\tat com.databricks.threading.NamedExecutor.withAttributionContext(NamedExecutor.scala:190)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1.run(NamedExecutor.scala:237)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1.480496157065E12,"submitTime":1.480496157472E12,"finishTime":1.480496157477E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"bf8c2f09-3625-4935-a25b-274e6149f3a3"},{"version":"CommandV1","origId":996009626413043,"guid":"526a0e48-2435-418c-ae85-e0421e0cb8ff","subtype":"command","commandType":"auto","position":2.0,"command":"1+1\n","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">2</span><span class=\"ansired\">]: </span>2\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Internal error, sorry. Attach your notebook to a different cluster or restart the current cluster.","error":"java.net.ConnectException: Connection refused\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)\n\tat sun.nio.ch.SocketAdaptor.connect(SocketAdaptor.java:111)\n\tat org.eclipse.jetty8.client.SelectConnector.startConnection(SelectConnector.java:79)\n\tat org.eclipse.jetty8.client.HttpDestination.startNewConnection(HttpDestination.java:283)\n\tat org.eclipse.jetty8.client.HttpDestination.doSend(HttpDestination.java:575)\n\tat org.eclipse.jetty8.client.HttpDestination.send(HttpDestination.java:513)\n\tat org.eclipse.jetty8.client.HttpClient.send(HttpClient.java:164)\n\tat com.databricks.rpc.JettyClient$$anonfun$sendRawExchange$1.apply$mcV$sp(JettyClient.scala:258)\n\tat com.databricks.rpc.JettyClient$$anonfun$sendRawExchange$1.apply(JettyClient.scala:248)\n\tat com.databricks.rpc.JettyClient$$anonfun$sendRawExchange$1.apply(JettyClient.scala:248)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:145)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:140)\n\tat com.databricks.rpc.JettyClient.withAttributionContext(JettyClient.scala:31)\n\tat com.databricks.rpc.JettyClient.sendRawExchange(JettyClient.scala:248)\n\tat com.databricks.rpc.JettyClient.sendExchange(JettyClient.scala:160)\n\tat com.databricks.rpc.JettyClient.sendAsync(JettyClient.scala:98)\n\tat com.databricks.rpc.BoundRPCClient.sendAsync(BoundRPCClient.scala:43)\n\tat com.databricks.backend.daemon.driver.DriverClient.com$databricks$backend$daemon$driver$DriverClient$$send(DriverClient.scala:78)\n\tat com.databricks.backend.daemon.driver.DriverClient$$anonfun$3.apply(DriverClient.scala:243)\n\tat com.databricks.backend.daemon.driver.DriverClient$$anonfun$3.apply(DriverClient.scala:243)\n\tat com.databricks.util.FutureUtils$.retry(FutureUtils.scala:89)\n\tat com.databricks.util.FutureUtils$$anonfun$retry$1.applyOrElse(FutureUtils.scala:93)\n\tat com.databricks.util.FutureUtils$$anonfun$retry$1.applyOrElse(FutureUtils.scala:91)\n\tat scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:344)\n\tat scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:343)\n\tat scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1$$anonfun$run$1.apply$mcV$sp(NamedExecutor.scala:238)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1$$anonfun$run$1.apply(NamedExecutor.scala:238)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1$$anonfun$run$1.apply(NamedExecutor.scala:238)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:145)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:140)\n\tat com.databricks.threading.NamedExecutor.withAttributionContext(NamedExecutor.scala:190)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1.run(NamedExecutor.scala:237)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1.480496166538E12,"submitTime":1.48049616719E12,"finishTime":1.480496166563E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"33bb9ffd-adc1-4882-ada1-0875774dbd96"},{"version":"CommandV1","origId":996009626413044,"guid":"eb1b7868-52a9-4d4e-95e0-5ccbab5286a4","subtype":"command","commandType":"auto","position":2.5,"command":"inputPath= \"/mnt/apacheLogs\"","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496177037E12,"submitTime":1.480496177688E12,"finishTime":1.480496177109E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5de3b73b-01d7-4b73-a271-17f9de0a9c9d"},{"version":"CommandV1","origId":996009626413045,"guid":"1788b57d-9765-4b1c-9101-201fc2fb2738","subtype":"command","commandType":"auto","position":3.0,"command":"display(dbutils.fs.ls(\"/mnt/apacheLogs\"))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part0.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part0.txt",2179.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part1.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part1.txt",2193.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part10.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part10.txt",2157.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part100.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part100.txt",2113.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part101.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part101.txt",2123.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part102.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part102.txt",2096.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part103.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part103.txt",2118.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part104.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part104.txt",2098.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part105.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part105.txt",2185.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part106.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part106.txt",2169.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part11.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part11.txt",2097.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part12.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part12.txt",2191.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part13.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part13.txt",2201.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part14.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part14.txt",2099.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part15.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part15.txt",2049.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part16.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part16.txt",2226.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part17.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part17.txt",2074.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part18.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part18.txt",2132.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part19.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part19.txt",2070.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part2.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part2.txt",2157.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part20.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part20.txt",2149.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part21.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part21.txt",2074.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part22.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part22.txt",2087.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part23.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part23.txt",2104.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part24.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part24.txt",2097.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part25.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part25.txt",2147.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part26.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part26.txt",2118.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part27.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part27.txt",2085.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part28.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part28.txt",2062.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part29.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part29.txt",2084.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part3.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part3.txt",2051.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part30.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part30.txt",2085.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part31.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part31.txt",2102.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part32.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part32.txt",2128.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part33.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part33.txt",2143.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part34.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part34.txt",2074.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part35.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part35.txt",2159.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part36.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part36.txt",2144.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part37.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part37.txt",2059.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part38.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part38.txt",2070.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part39.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part39.txt",2118.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part4.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part4.txt",2199.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part40.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part40.txt",2077.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part41.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part41.txt",2121.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part42.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part42.txt",2069.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part43.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part43.txt",2168.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part44.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part44.txt",2096.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part45.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part45.txt",2059.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part46.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part46.txt",2110.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part47.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part47.txt",2149.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part48.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part48.txt",2138.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part49.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part49.txt",2131.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part5.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part5.txt",2171.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part50.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part50.txt",2084.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part51.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part51.txt",2157.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part52.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part52.txt",2052.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part53.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part53.txt",2109.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part54.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part54.txt",2108.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part55.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part55.txt",2125.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part56.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part56.txt",2189.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part57.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part57.txt",2174.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part58.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part58.txt",2110.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part59.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part59.txt",2132.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part6.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part6.txt",2132.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part60.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part60.txt",2070.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part61.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part61.txt",2158.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part62.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part62.txt",2145.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part63.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part63.txt",2166.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part64.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part64.txt",2091.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part65.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part65.txt",2049.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part66.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part66.txt",2145.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part67.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part67.txt",2140.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part68.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part68.txt",2093.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part69.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part69.txt",2172.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part7.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part7.txt",2115.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part70.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part70.txt",2095.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part71.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part71.txt",2049.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part72.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part72.txt",2097.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part73.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part73.txt",2156.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part74.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part74.txt",2132.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part75.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part75.txt",2051.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part76.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part76.txt",2111.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part77.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part77.txt",2113.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part78.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part78.txt",2180.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part79.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part79.txt",2134.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part8.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part8.txt",2080.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part80.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part80.txt",2142.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part81.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part81.txt",2145.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part82.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part82.txt",2084.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part83.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part83.txt",2153.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part84.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part84.txt",2178.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part85.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part85.txt",2110.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part86.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part86.txt",2155.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part87.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part87.txt",2172.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part88.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part88.txt",2151.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part89.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part89.txt",2053.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part9.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part9.txt",2146.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part90.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part90.txt",2171.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part91.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part91.txt",2117.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part92.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part92.txt",2125.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part93.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part93.txt",2105.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part94.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part94.txt",2075.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part95.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part95.txt",2134.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part96.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part96.txt",2140.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part97.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part97.txt",2153.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part98.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part98.txt",2147.0],["dbfs:/mnt/apacheLogs/Log_finalls.s3.acer4520.2016-11-20T18.30.part99.txt","Log_finalls.s3.acer4520.2016-11-20T18.30.part99.txt",2088.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.48049618316E12,"submitTime":1.480496183813E12,"finishTime":1.480496188594E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"45c88ec8-2f5a-4c88-8fa6-c42bd5c91356"},{"version":"CommandV1","origId":996009626413046,"guid":"5c221bbe-ffe3-4cd0-b4e1-537ebab27e54","subtype":"command","commandType":"auto","position":4.0,"command":"spark","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">5</span><span class=\"ansired\">]: </span>&lt;pyspark.sql.session.SparkSession at 0x7fe50521cc90&gt;\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Internal error, sorry. Attach your notebook to a different cluster or restart the current cluster.","error":"java.net.ConnectException: Connection refused\n\tat sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)\n\tat sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:717)\n\tat sun.nio.ch.SocketAdaptor.connect(SocketAdaptor.java:111)\n\tat org.eclipse.jetty8.client.SelectConnector.startConnection(SelectConnector.java:79)\n\tat org.eclipse.jetty8.client.HttpDestination.startNewConnection(HttpDestination.java:283)\n\tat org.eclipse.jetty8.client.HttpDestination.doSend(HttpDestination.java:575)\n\tat org.eclipse.jetty8.client.HttpDestination.send(HttpDestination.java:513)\n\tat org.eclipse.jetty8.client.HttpClient.send(HttpClient.java:164)\n\tat com.databricks.rpc.JettyClient$$anonfun$sendRawExchange$1.apply$mcV$sp(JettyClient.scala:258)\n\tat com.databricks.rpc.JettyClient$$anonfun$sendRawExchange$1.apply(JettyClient.scala:248)\n\tat com.databricks.rpc.JettyClient$$anonfun$sendRawExchange$1.apply(JettyClient.scala:248)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:145)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:140)\n\tat com.databricks.rpc.JettyClient.withAttributionContext(JettyClient.scala:31)\n\tat com.databricks.rpc.JettyClient.sendRawExchange(JettyClient.scala:248)\n\tat com.databricks.rpc.JettyClient.sendExchange(JettyClient.scala:160)\n\tat com.databricks.rpc.JettyClient.sendAsync(JettyClient.scala:98)\n\tat com.databricks.rpc.BoundRPCClient.sendAsync(BoundRPCClient.scala:43)\n\tat com.databricks.backend.daemon.driver.DriverClient.com$databricks$backend$daemon$driver$DriverClient$$send(DriverClient.scala:78)\n\tat com.databricks.backend.daemon.driver.DriverClient$$anonfun$3.apply(DriverClient.scala:243)\n\tat com.databricks.backend.daemon.driver.DriverClient$$anonfun$3.apply(DriverClient.scala:243)\n\tat com.databricks.util.FutureUtils$.retry(FutureUtils.scala:91)\n\tat com.databricks.util.FutureUtils$$anonfun$retry$1.applyOrElse(FutureUtils.scala:93)\n\tat com.databricks.util.FutureUtils$$anonfun$retry$1.applyOrElse(FutureUtils.scala:91)\n\tat scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:344)\n\tat scala.concurrent.Future$$anonfun$recoverWith$1.apply(Future.scala:343)\n\tat scala.concurrent.impl.CallbackRunnable.run(Promise.scala:32)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1$$anonfun$run$1.apply$mcV$sp(NamedExecutor.scala:238)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1$$anonfun$run$1.apply(NamedExecutor.scala:238)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1$$anonfun$run$1.apply(NamedExecutor.scala:238)\n\tat com.databricks.logging.UsageLogging$$anonfun$withAttributionContext$1.apply(UsageLogging.scala:145)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:57)\n\tat com.databricks.logging.UsageLogging$class.withAttributionContext(UsageLogging.scala:140)\n\tat com.databricks.threading.NamedExecutor.withAttributionContext(NamedExecutor.scala:190)\n\tat com.databricks.threading.NamedExecutor$$anonfun$com$databricks$threading$NamedExecutor$$execute0$1$$anonfun$apply$mcV$sp$1$$anon$1.run(NamedExecutor.scala:237)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n","workflows":[],"startTime":1.480496188777E12,"submitTime":1.480496185422E12,"finishTime":1.480496188866E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"c28bdec9-da94-4c87-b3dd-7d119ac4b836"},{"version":"CommandV1","origId":996009626413047,"guid":"fd011ef1-9001-4537-91e3-b419343f13e2","subtype":"command","commandType":"auto","position":4.625,"command":"llk= spark.read.text(\"/mnt/apacheLogs\")\nllk.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">6</span><span class=\"ansired\">]: </span>1546\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496188884E12,"submitTime":1.480496187465E12,"finishTime":1.480496201358E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"20755ac3-5910-42ee-92c7-c3df5dbf1e77"},{"version":"CommandV1","origId":996009626413048,"guid":"5d13cd4e-e24f-4b20-b9ae-ec219d440dce","subtype":"command","commandType":"auto","position":4.6875,"command":"#llk.show()\ndisplay(llk.limit(10))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["2016-11-20T10:30:40.801Z acer4520 64.242.88.10 - - [08/Mar/2004:01:04:05 -0800] \"GET /twiki/bin/edit/TWiki/WikiStyleWord?topicparent=TWiki.TextFormattingFAQ HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.801Z acer4520 lj1089.inktomisearch.com - - [08/Mar/2004:01:04:54 -0800] \"GET /twiki/bin/oops/TWiki/InterWikis HTTP/1.0\" 200 209"],["2016-11-20T10:30:40.802Z acer4520 64.242.88.10 - - [08/Mar/2004:01:10:43 -0800] \"GET /twiki/bin/view/TWiki/FormattedSearch?rev=1.8 HTTP/1.1\" 200 20434"],["2016-11-20T10:30:40.802Z acer4520 64.242.88.10 - - [08/Mar/2004:01:12:20 -0800] \"GET /twiki/bin/view/TWiki/TWikiEnhancementRequests?rev=1.3 HTTP/1.1\" 200 4379"],["2016-11-20T10:30:40.802Z acer4520 64.242.88.10 - - [08/Mar/2004:01:16:37 -0800] \"GET /twiki/bin/view/Main/FileAttachment?rev=1.2 HTTP/1.1\" 200 17919"],["2016-11-20T10:30:40.803Z acer4520 64.242.88.10 - - [08/Mar/2004:01:19:18 -0800] \"GET /twiki/bin/edit/TWiki/AppendixFileSystem?t=1078674582 HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.803Z acer4520 64.242.88.10 - - [08/Mar/2004:01:24:13 -0800] \"GET /twiki/bin/view/TWiki/TextFormattingRules?rev=r1.33 HTTP/1.1\" 200 26294"],["2016-11-20T10:30:40.803Z acer4520 64.242.88.10 - - [08/Mar/2004:01:25:15 -0800] \"GET /twiki/bin/search/Main/?scope=topic&regex=on&search=^t HTTP/1.1\" 200 8306"],["2016-11-20T10:30:40.804Z acer4520 64.242.88.10 - - [08/Mar/2004:01:29:17 -0800] \"GET /twiki/bin/oops/TWiki/TWikiPlugins?template=oopsmore&param1=1.21&param2=1.21 HTTP/1.1\" 200 11341"],["2016-11-20T10:30:40.804Z acer4520 64.242.88.10 - - [08/Mar/2004:01:30:39 -0800] \"GET /mailman/private/sswk/ HTTP/1.1\" 200 1531"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"value","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496201367E12,"submitTime":1.480496189605E12,"finishTime":1.480496202107E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5b4d3409-3004-45a5-97b9-2eb0d9790cdb"},{"version":"CommandV1","origId":996009626413049,"guid":"2c697c79-887f-46c1-a0cf-73a25ad3d918","subtype":"command","commandType":"auto","position":4.71875,"command":"from pyspark.sql.functions import split, regexp_extract\nfrom pyspark.sql.types import *\n\nsplit_df =llk.select(#regexp_extract('value', r'^([^\\s]+\\s)', 1).alias('a'),\n                     #regexp_extract('value', r'^(\\w+)', 1).alias('b'),\n                     regexp_extract('value', r'^.*(\\d+\\.\\d+\\.\\d+\\.\\d+)', 1).alias('host'),\n                     #regexp_extract('value', r'.*^([^\\s]+\\s)', 1).alias('host'),\n                     regexp_extract('value', r'^.*\\[(\\d\\d/\\w{3}/\\d{4}:\\d{2}:\\d{2}:\\d{2} -\\d{4})]', 1).alias('timestamp'),\n                     regexp_extract('value', r'^.*\"\\w+\\s+([^\\s]+)\\s+HTTP.*\"', 1).alias('path'),\n                     regexp_extract('value', r'^.*\"\\s+([^\\s]+)', 1).cast('integer').alias('status'),\n                     regexp_extract('value', r'^.*\\s+(\\d+)$', 1).cast('integer').alias('content_size'))\nsplit_df.show(truncate=False)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+-----------+--------------------------+---------------------------------------------------------------------------------------------------------+------+------------+\n|host       |timestamp                 |path                                                                                                     |status|content_size|\n+-----------+--------------------------+---------------------------------------------------------------------------------------------------------+------+------------+\n|4.242.88.10|08/Mar/2004:01:04:05 -0800|/twiki/bin/edit/TWiki/WikiStyleWord?topicparent=TWiki.TextFormattingFAQ                                  |401   |12846       |\n|           |08/Mar/2004:01:04:54 -0800|/twiki/bin/oops/TWiki/InterWikis                                                                         |200   |209         |\n|4.242.88.10|08/Mar/2004:01:10:43 -0800|/twiki/bin/view/TWiki/FormattedSearch?rev=1.8                                                            |200   |20434       |\n|4.242.88.10|08/Mar/2004:01:12:20 -0800|/twiki/bin/view/TWiki/TWikiEnhancementRequests?rev=1.3                                                   |200   |4379        |\n|4.242.88.10|08/Mar/2004:01:16:37 -0800|/twiki/bin/view/Main/FileAttachment?rev=1.2                                                              |200   |17919       |\n|4.242.88.10|08/Mar/2004:01:19:18 -0800|/twiki/bin/edit/TWiki/AppendixFileSystem?t=1078674582                                                    |401   |12846       |\n|4.242.88.10|08/Mar/2004:01:24:13 -0800|/twiki/bin/view/TWiki/TextFormattingRules?rev=r1.33                                                      |200   |26294       |\n|4.242.88.10|08/Mar/2004:01:25:15 -0800|/twiki/bin/search/Main/?scope=topic&amp;regex=on&amp;search=^t                                                   |200   |8306        |\n|4.242.88.10|08/Mar/2004:01:29:17 -0800|/twiki/bin/oops/TWiki/TWikiPlugins?template=oopsmore&amp;param1=1.21&amp;param2=1.21                             |200   |11341       |\n|4.242.88.10|08/Mar/2004:01:30:39 -0800|/mailman/private/sswk/                                                                                   |200   |1531        |\n|4.242.88.10|08/Mar/2004:01:33:14 -0800|/mailman/private/business/                                                                               |200   |1543        |\n|4.242.88.10|08/Mar/2004:01:35:13 -0800|/twiki/bin/edit/TWiki/InterWikis?t=1078696998                                                            |401   |12846       |\n|4.242.88.10|08/Mar/2004:01:41:14 -0800|/twiki/bin/view/TWiki/WelcomeGuest?rev=r1.18                                                             |200   |14001       |\n|4.242.88.10|08/Mar/2004:01:46:05 -0800|/twiki/bin/search/TWiki/?search=\\\\.*&amp;scope=topic&amp;order=modified&amp;reverse=on&amp;regex=on&amp;nosearch=on&amp;limit=200|200   |101279      |\n|4.242.88.10|07/Mar/2004:23:15:51 -0800|/twiki/bin/view/TWiki/TextFormattingRules?rev=r1.24                                                      |200   |20981       |\n|4.242.88.10|07/Mar/2004:23:16:57 -0800|/twiki/bin/rdiff/Main/SanJoseOffice                                                                      |200   |9524        |\n|4.242.88.10|07/Mar/2004:23:19:01 -0800|/twiki/bin/rdiff/Main/WebNotify                                                                          |200   |16853       |\n|4.242.88.10|07/Mar/2004:23:20:26 -0800|/twiki/bin/view/TWiki/TWikiSiteTools                                                                     |200   |14435       |\n|4.242.88.10|07/Mar/2004:23:23:00 -0800|/twiki/bin/rdiff/TWiki/RichardDonkin?rev1=1.2&amp;rev2=1.1                                                   |200   |5891        |\n|4.242.88.10|07/Mar/2004:23:27:26 -0800|/twiki/bin/search/TWiki/SearchResult?scope=text&amp;regex=on&amp;search=Web%20*Preferences[^A-Za-z]              |200   |20030       |\n+-----------+--------------------------+---------------------------------------------------------------------------------------------------------+------+------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496202118E12,"submitTime":1.480496191882E12,"finishTime":1.480496203831E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7ff3e340-c3fe-4afd-9a21-e4d158642ddb"},{"version":"CommandV1","origId":996009626413050,"guid":"3d9b1e11-bd4a-489c-bf47-760cded5a3d3","subtype":"command","commandType":"auto","position":4.7265625,"command":"display(split_df.limit(10))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["4.242.88.10","08/Mar/2004:01:04:05 -0800","/twiki/bin/edit/TWiki/WikiStyleWord?topicparent=TWiki.TextFormattingFAQ",401.0,12846.0],["","08/Mar/2004:01:04:54 -0800","/twiki/bin/oops/TWiki/InterWikis",200.0,209.0],["4.242.88.10","08/Mar/2004:01:10:43 -0800","/twiki/bin/view/TWiki/FormattedSearch?rev=1.8",200.0,20434.0],["4.242.88.10","08/Mar/2004:01:12:20 -0800","/twiki/bin/view/TWiki/TWikiEnhancementRequests?rev=1.3",200.0,4379.0],["4.242.88.10","08/Mar/2004:01:16:37 -0800","/twiki/bin/view/Main/FileAttachment?rev=1.2",200.0,17919.0],["4.242.88.10","08/Mar/2004:01:19:18 -0800","/twiki/bin/edit/TWiki/AppendixFileSystem?t=1078674582",401.0,12846.0],["4.242.88.10","08/Mar/2004:01:24:13 -0800","/twiki/bin/view/TWiki/TextFormattingRules?rev=r1.33",200.0,26294.0],["4.242.88.10","08/Mar/2004:01:25:15 -0800","/twiki/bin/search/Main/?scope=topic&regex=on&search=^t",200.0,8306.0],["4.242.88.10","08/Mar/2004:01:29:17 -0800","/twiki/bin/oops/TWiki/TWikiPlugins?template=oopsmore&param1=1.21&param2=1.21",200.0,11341.0],["4.242.88.10","08/Mar/2004:01:30:39 -0800","/mailman/private/sswk/",200.0,1531.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"host","type":"\"string\"","metadata":"{}"},{"name":"timestamp","type":"\"string\"","metadata":"{}"},{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"status","type":"\"integer\"","metadata":"{}"},{"name":"content_size","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.48049620384E12,"submitTime":1.480496194172E12,"finishTime":1.480496204468E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a972ce81-a844-4d24-8fa4-39bf9b4ce13f"},{"version":"CommandV1","origId":996009626413051,"guid":"17bc3601-9a18-4262-8b46-b34b71817d97","subtype":"command","commandType":"auto","position":4.734375,"command":"bad_rows_df = split_df.filter(split_df['host'].isNull() |\n                              split_df['timestamp'].isNull() |\n                              split_df['path'].isNull() |\n                              split_df['status'].isNull() |\n                             split_df['content_size'].isNull())\nbad_rows_df.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">10</span><span class=\"ansired\">]: </span>139\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496204476E12,"submitTime":1.480496196598E12,"finishTime":1.480496214731E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"d1e52873-e4ce-4b51-9863-ece7df3ddb08"},{"version":"CommandV1","origId":996009626413052,"guid":"330897dd-9263-4dd0-8345-4cd9f8faa2ee","subtype":"command","commandType":"auto","position":4.7421875,"command":"from pyspark.sql.functions import col, sum\n\ndef count_null(col_name):\n  return sum(col(col_name).isNull().cast('integer')).alias(col_name)\n\n# Build up a list of column expressions, one per column.\n#\n# This could be done in one line with a Python list comprehension, but we're keeping\n# it simple for those who don't know Python very well.\nexprs = []\nfor col_name in split_df.columns:\n  exprs.append(count_null(col_name))\n\n# Run the aggregation. The *exprs converts the list of expressions into\n# variable function arguments.\nsplit_df.agg(*exprs).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+---------+----+------+------------+\n|host|timestamp|path|status|content_size|\n+----+---------+----+------+------------+\n|   0|        0|   0|     0|         139|\n+----+---------+----+------+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496214738E12,"submitTime":1.48049619873E12,"finishTime":1.480496224389E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8a8f93dd-d01d-4297-87fc-f6c0c820507e"},{"version":"CommandV1","origId":996009626413053,"guid":"f61ee7b5-e959-4777-8216-9e2e6acd7cd6","subtype":"command","commandType":"auto","position":4.74609375,"command":"# Replace all null content_size values with 0.\ncleaned_df = split_df.na.fill({'content_size': 0})","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496224397E12,"submitTime":1.480496218742E12,"finishTime":1.480496224467E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e5c4579f-4a4f-4839-b568-9c480b53dc90"},{"version":"CommandV1","origId":996009626413054,"guid":"958b8406-54c8-4977-b5c0-f9dd41350d66","subtype":"command","commandType":"auto","position":4.748046875,"command":"exprs = []\nfor col_name in cleaned_df.columns:\n  exprs.append(count_null(col_name))\n\ncleaned_df.agg(*exprs).show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">+----+---------+----+------+------------+\n|host|timestamp|path|status|content_size|\n+----+---------+----+------+------------+\n|   0|        0|   0|     0|           0|\n+----+---------+----+------+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496224474E12,"submitTime":1.48049622055E12,"finishTime":1.480496234023E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"422abfd1-c754-4e32-9e32-0abf955e44c5"},{"version":"CommandV1","origId":996009626413055,"guid":"c01369a2-5c26-408f-999e-e98254b4c6bf","subtype":"command","commandType":"auto","position":4.74853515625,"command":"month_map = {\n  'Jan': 1, 'Feb': 2, 'Mar':3, 'Apr':4, 'May':5, 'Jun':6, 'Jul':7,\n  'Aug':8,  'Sep': 9, 'Oct':10, 'Nov': 11, 'Dec': 12\n}\n\ndef parse_clf_time(s):\n    \"\"\" Convert Common Log time format into a Python datetime object\n    Args:\n        s (str): date and time in Apache time format [dd/mmm/yyyy:hh:mm:ss (+/-)zzzz]\n    Returns:\n        a string suitable for passing to CAST('timestamp')\n    \"\"\"\n    # NOTE: We're ignoring time zone here. In a production application, you'd want to handle that.\n    return \"{0:04d}-{1:02d}-{2:02d} {3:02d}:{4:02d}:{5:02d}\".format(\n      int(s[7:11]),\n      month_map[s[3:6]],\n      int(s[0:2]),\n      int(s[12:14]),\n      int(s[15:17]),\n      int(s[18:20])\n    )\n\nu_parse_time = udf(parse_clf_time)\n\nlogs_df = cleaned_df.select('*', u_parse_time(split_df['timestamp']).cast('timestamp').alias('time')).drop('timestamp')\ntotal_log_entries = logs_df.count()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.48049623403E12,"submitTime":1.480496222528E12,"finishTime":1.480496242877E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"46c65a13-4268-4072-af20-95d98c822a08"},{"version":"CommandV1","origId":996009626413056,"guid":"d80e8eb7-011a-4cc8-8144-f7522014f62d","subtype":"command","commandType":"auto","position":4.7490234375,"command":"display(logs_df.limit(10))","commandVersion":0,"state":"finished","results":{"type":"table","data":[["4.242.88.10","/twiki/bin/edit/TWiki/WikiStyleWord?topicparent=TWiki.TextFormattingFAQ",401.0,12846.0,"2004-03-08T01:04:05.000+0000"],["","/twiki/bin/oops/TWiki/InterWikis",200.0,209.0,"2004-03-08T01:04:54.000+0000"],["4.242.88.10","/twiki/bin/view/TWiki/FormattedSearch?rev=1.8",200.0,20434.0,"2004-03-08T01:10:43.000+0000"],["4.242.88.10","/twiki/bin/view/TWiki/TWikiEnhancementRequests?rev=1.3",200.0,4379.0,"2004-03-08T01:12:20.000+0000"],["4.242.88.10","/twiki/bin/view/Main/FileAttachment?rev=1.2",200.0,17919.0,"2004-03-08T01:16:37.000+0000"],["4.242.88.10","/twiki/bin/edit/TWiki/AppendixFileSystem?t=1078674582",401.0,12846.0,"2004-03-08T01:19:18.000+0000"],["4.242.88.10","/twiki/bin/view/TWiki/TextFormattingRules?rev=r1.33",200.0,26294.0,"2004-03-08T01:24:13.000+0000"],["4.242.88.10","/twiki/bin/search/Main/?scope=topic&regex=on&search=^t",200.0,8306.0,"2004-03-08T01:25:15.000+0000"],["4.242.88.10","/twiki/bin/oops/TWiki/TWikiPlugins?template=oopsmore&param1=1.21&param2=1.21",200.0,11341.0,"2004-03-08T01:29:17.000+0000"],["4.242.88.10","/mailman/private/sswk/",200.0,1531.0,"2004-03-08T01:30:39.000+0000"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"host","type":"\"string\"","metadata":"{}"},{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"status","type":"\"integer\"","metadata":"{}"},{"name":"content_size","type":"\"integer\"","metadata":"{}"},{"name":"time","type":"\"timestamp\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496242885E12,"submitTime":1.480496225316E12,"finishTime":1.480496251214E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a5d0acfe-3ede-4f32-aa10-84c9d3cac0f1"},{"version":"CommandV1","origId":996009626413057,"guid":"28113f90-3bf2-4f7d-ace0-37602dee6cf8","subtype":"command","commandType":"auto","position":4.75,"command":"logs_df.cache()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">16</span><span class=\"ansired\">]: </span>DataFrame[host: string, path: string, status: int, content_size: int, time: timestamp]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496251231E12,"submitTime":1.480496227942E12,"finishTime":1.480496251402E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"70692b63-b92d-4ca6-a771-0eb6bb8c7644"},{"version":"CommandV1","origId":996009626413058,"guid":"8e64c333-acf9-4a7e-ae75-bcc1cacfc614","subtype":"command","commandType":"auto","position":5.0,"command":"status_to_count_df =(logs_df\n                     .groupBy('status')\n                     .count()\n                     .sort('status')\n                     .cache())","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496251411E12,"submitTime":1.480496230344E12,"finishTime":1.480496260759E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"8cdd22fd-4831-4a37-95f9-fa73f3fee8c2"},{"version":"CommandV1","origId":996009626413059,"guid":"e1cc9b3f-f579-473b-b0e7-0bfd2c336139","subtype":"command","commandType":"auto","position":5.5,"command":"display(status_to_count_df)\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[[200.0,1274.0],[302.0,6.0],[304.0,137.0],[401.0,123.0],[404.0,5.0],[408.0,1.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"status","type":"\"integer\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496260775E12,"submitTime":1.48049623324E12,"finishTime":1.480496261396E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"dc150254-700a-488e-ad69-2c0b57315666"},{"version":"CommandV1","origId":996009626413060,"guid":"8611f620-7c00-467f-b02d-42c4b06eb8fd","subtype":"command","commandType":"auto","position":7.75,"command":"host_sum_df =(logs_df\n              .groupBy('host')\n              .count()\n             .sort('count', ascending=False))\n\ndisplay(host_sum_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["",685.0],["4.242.88.10",452.0],["0.0.0.153",270.0],["7.195.59.160",20.0],["8.227.88.79",14.0],["2.92.37.62",14.0],["3.147.138.233",13.0],["5.246.13.119",12.0],["3.54.168.132",12.0],["2.27.64.35",7.0],["5.253.208.9",7.0],["4.151.73.43",4.0],["0.58.14.235",4.0],["8.247.148.12",4.0],["1.165.64.6",4.0],["7.131.107.5",3.0],["0.58.33.42",3.0],["1.9.4.61",3.0],["0.160.249.68",2.0],["2.21.228.26",1.0],["9.95.17.51",1.0],["0.58.35.111",1.0],["5.230.181.122",1.0],["4.37.97.186",1.0],["4.246.94.152",1.0],["6.139.185.45",1.0],["6.213.206.2",1.0],["0.222.33.33",1.0],["4.246.94.141",1.0],["5.11.231.210",1.0],["3.181.81.4",1.0],["2.22.207.235",1.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"host","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496261405E12,"submitTime":1.480496236671E12,"finishTime":1.480496262313E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9cc5b05e-e836-4e8a-84d6-750010a6c22c"},{"version":"CommandV1","origId":996009626413061,"guid":"a745e98d-5c5d-45ea-be31-632f3992d5cd","subtype":"command","commandType":"auto","position":8.875,"command":"paths_df = (logs_df\n            .groupBy('path')\n            .count()\n            .sort('count', ascending=False)).take(10)\ndisplay(paths_df)\n\n\n  ","commandVersion":0,"state":"finished","results":{"type":"table","data":[["/twiki/pub/TWiki/TWikiLogos/twikiRobot46x50.gif",64.0],["/",47.0],["/twiki/bin/view/Main/WebHome",41.0],["/icons/gnu-head-tiny.jpg",37.0],["/icons/PythonPowered.png",37.0],["/icons/mailman.jpg",37.0],["/favicon.ico",28.0],["/robots.txt",27.0],["/razor.html",26.0],["/twiki/bin/view/Main/SpamAssassinTaggingOnly",18.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496262324E12,"submitTime":1.480496239742E12,"finishTime":1.480496263252E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"1067","height":"326","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"94a73dc7-f6a0-40d8-b9ad-d3f74867263c"},{"version":"CommandV1","origId":996009626413062,"guid":"990e684c-910a-4344-927f-daa803649b87","subtype":"command","commandType":"auto","position":9.4375,"command":"from pyspark.sql.functions import dayofmonth\n\nday_to_host_pair_df = logs_df.select('host', dayofmonth('time').alias('day'))\nday_group_hosts_df = day_to_host_pair_df.dropDuplicates()\n\ndaily_hosts_df = day_group_hosts_df.groupBy('day').count().withColumnRenamed('count', 'uniqueHost').sort('count', ascending= False).cache()\n\nprint 'Unique hosts per day:'\ndaily_hosts_df.sort('day', ascending= True).show(30, False)\n\ndays_with_hosts, hosts = [list(r) for r in zip(*daily_hosts_df.collect())]\n#0.27s\n\n\n  \nprint(days_with_hosts)\nprint(hosts)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Unique hosts per day:\n+---+----------+\n|day|uniqueHost|\n+---+----------+\n|7  |2         |\n|8  |12        |\n|9  |8         |\n|10 |6         |\n|11 |6         |\n|12 |8         |\n+---+----------+\n\n[8, 12, 9, 10, 11, 7]\n[12, 8, 8, 6, 6, 2]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496263259E12,"submitTime":1.480496242153E12,"finishTime":1.480496265178E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b034d44c-f96a-4158-b970-6dc3f9d0155d"},{"version":"CommandV1","origId":996009626413063,"guid":"b31a15f1-4373-4189-b8db-2a9699f1c410","subtype":"command","commandType":"auto","position":9.71875,"command":"display(daily_hosts_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[8.0,12.0],[12.0,8.0],[9.0,8.0],[10.0,6.0],[11.0,6.0],[7.0,2.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"day","type":"\"integer\"","metadata":"{}"},{"name":"uniqueHost","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496265184E12,"submitTime":1.480496244243E12,"finishTime":1.480496265273E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3b39f103-acb8-43fe-a5ae-e5b1ac887e0c"},{"version":"CommandV1","origId":996009626413064,"guid":"93263224-11e0-42c8-b0d1-3a27e3569af8","subtype":"command","commandType":"auto","position":9.859375,"command":"total_req_per_day_df = logs_df.select('host', dayofmonth('time').alias('day')).groupBy('day').count()\n\navg_daily_req_per_host_df = (\n  total_req_per_day_df\n  .join(daily_hosts_df, 'day', 'left_outer')\n  .select('day', (col('count') / col('uniqueHost'))\n          .cast('integer')\n          .alias('avg_reqs_per_host_per_day'))\n  .cache()\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496265279E12,"submitTime":1.480496246596E12,"finishTime":1.480496265601E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"a3fe1963-6452-4d58-907a-979fd2eaa81c"},{"version":"CommandV1","origId":996009626413065,"guid":"c6e0b3ec-dbd8-4feb-86fe-21e75fb1ab60","subtype":"command","commandType":"auto","position":9.9296875,"command":"print(\"Average daily hosts are given by:\")\navg_daily_req_per_host_df.show()","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\">Average daily hosts are given by:\n+---+-------------------------+\n|day|avg_reqs_per_host_per_day|\n+---+-------------------------+\n| 12|                        9|\n|  9|                       29|\n|  8|                       46|\n|  7|                       98|\n| 10|                       47|\n| 11|                       33|\n+---+-------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496265607E12,"submitTime":1.480496249295E12,"finishTime":1.480496266331E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"234","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fd20d881-8eb5-4768-b791-2aff0c3729b2"},{"version":"CommandV1","origId":996009626413066,"guid":"44ca3341-eaca-43d4-b4ce-35c0c05d6719","subtype":"command","commandType":"auto","position":9.96484375,"command":"from pyspark.sql.functions import *\nrrStream= (\n  spark    \n    .readStream                       \n    .option(\"maxFilesPerTrigger\", 1)  # Treat a sequence of files as a stream by picking one file at a time\n    .text(inputPath)\n)\nspark.conf.set(\"spark.sql.shuffle.partitions\", \"1\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496266339E12,"submitTime":1.480496252238E12,"finishTime":1.480496267062E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"4a067c99-f1e4-4477-b043-e1f98cb44855"},{"version":"CommandV1","origId":996009626413067,"guid":"39f53ea0-c94f-4a65-9e3b-4e1ec8e43857","subtype":"command","commandType":"auto","position":9.96923828125,"command":"rrStream.isStreaming","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">26</span><span class=\"ansired\">]: </span>True\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496267067E12,"submitTime":1.480496255252E12,"finishTime":1.48049626709E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"fbb4b3a7-1b24-400c-8a4e-1cea7fab81db"},{"version":"CommandV1","origId":996009626413069,"guid":"78f1a0a7-b495-4214-afbc-687b96fb3291","subtype":"command","commandType":"auto","position":9.9736328125,"command":"spark.conf.set(\"spark.sql.shuffle.partitions\", \"1\")","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496267096E12,"submitTime":1.480496258331E12,"finishTime":1.48049626711E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"14fdb668-b1b3-4354-bfd0-ad0de0b78c68"},{"version":"CommandV1","origId":996009626413068,"guid":"69c1a38b-7201-4855-be03-4a4028c5e210","subtype":"command","commandType":"auto","position":9.982421875,"command":"display(rrStream)","commandVersion":0,"state":"finished","results":{"type":"table","data":[["2016-11-20T10:30:29.750Z acer4520 64.242.88.10 - - [07/Mar/2004:16:05:49 -0800] \"GET /twiki/bin/edit/Main/Double_bounce_sender?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.423Z acer4520 64.242.88.10 - - [07/Mar/2004:16:06:51 -0800] \"GET /twiki/bin/rdiff/TWiki/NewUserTemplate?rev1=1.3&rev2=1.2 HTTP/1.1\" 200 4523"],["2016-11-20T10:30:40.426Z acer4520 64.242.88.10 - - [07/Mar/2004:16:10:02 -0800] \"GET /mailman/listinfo/hsdivision HTTP/1.1\" 200 6291"],["2016-11-20T10:30:40.428Z acer4520 64.242.88.10 - - [07/Mar/2004:16:11:58 -0800] \"GET /twiki/bin/view/TWiki/WikiSyntax HTTP/1.1\" 200 7352"],["2016-11-20T10:30:40.431Z acer4520 64.242.88.10 - - [07/Mar/2004:16:20:55 -0800] \"GET /twiki/bin/view/Main/DCCAndPostFix HTTP/1.1\" 200 5253"],["2016-11-20T10:30:40.436Z acer4520 64.242.88.10 - - [07/Mar/2004:16:23:12 -0800] \"GET /twiki/bin/oops/TWiki/AppendixFileSystem?template=oopsmore&param1=1.12&param2=1.12 HTTP/1.1\" 200 11382"],["2016-11-20T10:30:40.458Z acer4520 64.242.88.10 - - [07/Mar/2004:16:24:16 -0800] \"GET /twiki/bin/view/Main/PeterThoeny HTTP/1.1\" 200 4924"],["2016-11-20T10:30:40.460Z acer4520 64.242.88.10 - - [07/Mar/2004:16:29:16 -0800] \"GET /twiki/bin/edit/Main/Header_checks?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12851"],["2016-11-20T10:30:40.464Z acer4520 64.242.88.10 - - [07/Mar/2004:16:30:29 -0800] \"GET /twiki/bin/attach/Main/OfficeLocations HTTP/1.1\" 401 12851"],["2016-11-20T10:30:40.467Z acer4520 64.242.88.10 - - [07/Mar/2004:16:31:48 -0800] \"GET /twiki/bin/view/TWiki/WebTopicEditTemplate HTTP/1.1\" 200 3732"],["2016-11-20T10:30:40.469Z acer4520 64.242.88.10 - - [07/Mar/2004:16:32:50 -0800] \"GET /twiki/bin/view/Main/WebChanges HTTP/1.1\" 200 40520"],["2016-11-20T10:30:40.470Z acer4520 64.242.88.10 - - [07/Mar/2004:16:33:53 -0800] \"GET /twiki/bin/edit/Main/Smtpd_etrn_restrictions?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12851"],["2016-11-20T10:30:40.472Z acer4520 64.242.88.10 - - [07/Mar/2004:16:35:19 -0800] \"GET /mailman/listinfo/business HTTP/1.1\" 200 6379"],["2016-11-20T10:30:40.479Z acer4520 64.242.88.10 - - [07/Mar/2004:16:36:22 -0800] \"GET /twiki/bin/rdiff/Main/WebIndex?rev1=1.2&rev2=1.1 HTTP/1.1\" 200 46373"],["2016-11-20T10:30:40.480Z acer4520 64.242.88.10 - - [07/Mar/2004:16:37:27 -0800] \"GET /twiki/bin/view/TWiki/DontNotify HTTP/1.1\" 200 4140"],["2016-11-20T10:30:40.482Z acer4520 64.242.88.10 - - [07/Mar/2004:16:39:24 -0800] \"GET /twiki/bin/view/Main/TokyoOffice HTTP/1.1\" 200 3853"],["2016-11-20T10:30:40.484Z acer4520 64.242.88.10 - - [07/Mar/2004:16:43:54 -0800] \"GET /twiki/bin/view/Main/MikeMannix HTTP/1.1\" 200 3686"],["2016-11-20T10:30:40.485Z acer4520 64.242.88.10 - - [07/Mar/2004:16:45:56 -0800] \"GET /twiki/bin/attach/Main/PostfixCommands HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.491Z acer4520 64.242.88.10 - - [07/Mar/2004:16:47:12 -0800] \"GET /robots.txt HTTP/1.1\" 200 68"],["2016-11-20T10:30:40.493Z acer4520 64.242.88.10 - - [07/Mar/2004:16:47:46 -0800] \"GET /twiki/bin/rdiff/Know/ReadmeFirst?rev1=1.5&rev2=1.4 HTTP/1.1\" 200 5724"],["2016-11-20T10:30:40.498Z acer4520 64.242.88.10 - - [07/Mar/2004:16:49:04 -0800] \"GET /twiki/bin/view/Main/TWikiGroups?rev=1.2 HTTP/1.1\" 200 5162"],["2016-11-20T10:30:40.500Z acer4520 64.242.88.10 - - [07/Mar/2004:16:50:54 -0800] \"GET /twiki/bin/rdiff/Main/ConfigurationVariables HTTP/1.1\" 200 59679"],["2016-11-20T10:30:40.503Z acer4520 64.242.88.10 - - [07/Mar/2004:16:52:35 -0800] \"GET /twiki/bin/edit/Main/Flush_service_name?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12851"],["2016-11-20T10:30:40.505Z acer4520 64.242.88.10 - - [07/Mar/2004:16:53:46 -0800] \"GET /twiki/bin/rdiff/TWiki/TWikiRegistration HTTP/1.1\" 200 34395"],["2016-11-20T10:30:40.512Z acer4520 64.242.88.10 - - [07/Mar/2004:16:54:55 -0800] \"GET /twiki/bin/rdiff/Main/NicholasLee HTTP/1.1\" 200 7235"],["2016-11-20T10:30:40.516Z acer4520 64.242.88.10 - - [07/Mar/2004:16:56:39 -0800] \"GET /twiki/bin/view/Sandbox/WebHome?rev=1.6 HTTP/1.1\" 200 8545"],["2016-11-20T10:30:40.517Z acer4520 64.242.88.10 - - [07/Mar/2004:16:58:54 -0800] \"GET /mailman/listinfo/administration HTTP/1.1\" 200 6459"],["2016-11-20T10:30:40.519Z acer4520 lordgun.org - - [07/Mar/2004:17:01:53 -0800] \"GET /razor.html HTTP/1.1\" 200 2869"],["2016-11-20T10:30:40.520Z acer4520 64.242.88.10 - - [07/Mar/2004:17:09:01 -0800] \"GET /twiki/bin/search/Main/SearchResult?scope=text&regex=on&search=Joris%20*Benschop[^A-Za-z] HTTP/1.1\" 200 4284"],["2016-11-20T10:30:40.521Z acer4520 64.242.88.10 - - [07/Mar/2004:17:10:20 -0800] \"GET /twiki/bin/oops/TWiki/TextFormattingRules?template=oopsmore&param1=1.37&param2=1.37 HTTP/1.1\" 200 11400"],["2016-11-20T10:30:40.523Z acer4520 64.242.88.10 - - [07/Mar/2004:17:13:50 -0800] \"GET /twiki/bin/edit/TWiki/DefaultPlugin?t=1078688936 HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.526Z acer4520 64.242.88.10 - - [07/Mar/2004:17:16:00 -0800] \"GET /twiki/bin/search/Main/?scope=topic&regex=on&search=^g HTTP/1.1\" 200 3675"],["2016-11-20T10:30:40.528Z acer4520 64.242.88.10 - - [07/Mar/2004:17:17:27 -0800] \"GET /twiki/bin/search/TWiki/?scope=topic&regex=on&search=^d HTTP/1.1\" 200 5773"],["2016-11-20T10:30:40.533Z acer4520 lj1036.inktomisearch.com - - [07/Mar/2004:17:18:36 -0800] \"GET /robots.txt HTTP/1.0\" 200 68"],["2016-11-20T10:30:40.534Z acer4520 lj1090.inktomisearch.com - - [07/Mar/2004:17:18:41 -0800] \"GET /twiki/bin/view/Main/LondonOffice HTTP/1.0\" 200 3860"],["2016-11-20T10:30:40.543Z acer4520 64.242.88.10 - - [07/Mar/2004:17:21:44 -0800] \"GET /twiki/bin/attach/TWiki/TablePlugin HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.545Z acer4520 64.242.88.10 - - [07/Mar/2004:17:22:49 -0800] \"GET /twiki/bin/view/TWiki/ManagingWebs?rev=1.22 HTTP/1.1\" 200 9310"],["2016-11-20T10:30:40.551Z acer4520 64.242.88.10 - - [07/Mar/2004:17:23:54 -0800] \"GET /twiki/bin/statistics/Main HTTP/1.1\" 200 808"],["2016-11-20T10:30:40.554Z acer4520 64.242.88.10 - - [07/Mar/2004:17:26:30 -0800] \"GET /twiki/bin/view/TWiki/WikiCulture HTTP/1.1\" 200 5935"],["2016-11-20T10:30:40.555Z acer4520 64.242.88.10 - - [07/Mar/2004:17:27:37 -0800] \"GET /twiki/bin/edit/Main/WebSearch?t=1078669682 HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.557Z acer4520 64.242.88.10 - - [07/Mar/2004:17:28:45 -0800] \"GET /twiki/bin/oops/TWiki/ResetPassword?template=oopsmore&param1=1.4&param2=1.4 HTTP/1.1\" 200 11281"],["2016-11-20T10:30:40.561Z acer4520 64.242.88.10 - - [07/Mar/2004:17:29:59 -0800] \"GET /twiki/bin/view/TWiki/ManagingWebs?skin=print HTTP/1.1\" 200 8806"],["2016-11-20T10:30:40.562Z acer4520 64.242.88.10 - - [07/Mar/2004:17:31:39 -0800] \"GET /twiki/bin/edit/Main/UvscanAndPostFix?topicparent=Main.WebHome HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.562Z acer4520 64.242.88.10 - - [07/Mar/2004:17:35:35 -0800] \"GET /twiki/bin/view/TWiki/KlausWriessnegger HTTP/1.1\" 200 3848"],["2016-11-20T10:30:40.563Z acer4520 64.242.88.10 - - [07/Mar/2004:17:39:39 -0800] \"GET /twiki/bin/view/Main/SpamAssassin HTTP/1.1\" 200 4081"],["2016-11-20T10:30:40.564Z acer4520 64.242.88.10 - - [07/Mar/2004:17:42:15 -0800] \"GET /twiki/bin/oops/TWiki/RichardDonkin?template=oopsmore&param1=1.2&param2=1.2 HTTP/1.1\" 200 11281"],["2016-11-20T10:30:40.565Z acer4520 64.242.88.10 - - [07/Mar/2004:17:46:17 -0800] \"GET /twiki/bin/rdiff/TWiki/AlWilliams?rev1=1.3&rev2=1.2 HTTP/1.1\" 200 4485"],["2016-11-20T10:30:40.566Z acer4520 64.242.88.10 - - [07/Mar/2004:17:47:43 -0800] \"GET /twiki/bin/rdiff/TWiki/AlWilliams?rev1=1.2&rev2=1.1 HTTP/1.1\" 200 5234"],["2016-11-20T10:30:40.576Z acer4520 64.242.88.10 - - [07/Mar/2004:17:50:44 -0800] \"GET /twiki/bin/view/TWiki/SvenDowideit HTTP/1.1\" 200 3616"],["2016-11-20T10:30:40.577Z acer4520 64.242.88.10 - - [07/Mar/2004:17:53:45 -0800] \"GET /twiki/bin/search/Main/SearchResult?scope=text&regex=on&search=Office%20*Locations[^A-Za-z] HTTP/1.1\" 200 7771"],["2016-11-20T10:30:40.583Z acer4520 64.242.88.10 - - [07/Mar/2004:17:56:54 -0800] \"GET /twiki/bin/view/TWiki/TextFormattingRules?rev=r1.31 HTTP/1.1\" 200 23338"],["2016-11-20T10:30:40.584Z acer4520 64.242.88.10 - - [07/Mar/2004:17:58:00 -0800] \"GET /twiki/bin/edit/Main/KevinWGagel?t=1078670331 HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.584Z acer4520 64.242.88.10 - - [07/Mar/2004:18:00:09 -0800] \"GET /twiki/bin/edit/Main/Virtual_mailbox_lock?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.585Z acer4520 64.242.88.10 - - [07/Mar/2004:18:02:10 -0800] \"GET /twiki/bin/view/Main/WebPreferences HTTP/1.1\" 200 8820"],["2016-11-20T10:30:40.585Z acer4520 64.242.88.10 - - [07/Mar/2004:18:04:05 -0800] \"GET /twiki/bin/view/TWiki/WikiWord?rev=1.3 HTTP/1.1\" 200 6816"],["2016-11-20T10:30:40.585Z acer4520 lj1125.inktomisearch.com - - [07/Mar/2004:18:06:14 -0800] \"GET /twiki/bin/oops/Sandbox/WebChanges HTTP/1.0\" 200 209"],["2016-11-20T10:30:40.586Z acer4520 64.242.88.10 - - [07/Mar/2004:18:09:00 -0800] \"GET /twiki/bin/rdiff/Main/TWikiGuest HTTP/1.1\" 200 11314"],["2016-11-20T10:30:40.586Z acer4520 64.242.88.10 - - [07/Mar/2004:18:10:09 -0800] \"GET /twiki/bin/edit/TWiki/TWikiVariables?t=1078684115 HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.587Z acer4520 d207-6-9-183.bchsia.telus.net - - [07/Mar/2004:18:10:18 -0800] \"GET /pipermail/cncce/2004-January/000001.html HTTP/1.1\" 200 3095"],["2016-11-20T10:30:40.587Z acer4520 d207-6-9-183.bchsia.telus.net - - [07/Mar/2004:18:10:20 -0800] \"GET /pipermail/cncce/2004-January/000002.html HTTP/1.1\" 200 3810"],["2016-11-20T10:30:40.587Z acer4520 64.242.88.10 - - [07/Mar/2004:18:17:26 -0800] \"GET /twiki/bin/rdiff/TWiki/WikiWord?rev1=1.4&rev2=1.3 HTTP/1.1\" 200 6948"],["2016-11-20T10:30:40.588Z acer4520 64.242.88.10 - - [07/Mar/2004:18:19:01 -0800] \"GET /twiki/bin/edit/Main/TWikiPreferences?topicparent=Main.WebHome HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.588Z acer4520 d207-6-9-183.bchsia.telus.net - - [07/Mar/2004:18:19:16 -0800] \"GET /pipermail/cncce/2004-January.txt HTTP/1.1\" 200 3376"],["2016-11-20T10:30:40.589Z acer4520 64.242.88.10 - - [07/Mar/2004:18:22:52 -0800] \"GET /twiki/bin/search/Main/SearchResult?scope=text&regex=on&search=Web%20*Statistics[^A-Za-z] HTTP/1.1\" 200 3584"],["2016-11-20T10:30:40.589Z acer4520 64.242.88.10 - - [07/Mar/2004:18:26:32 -0800] \"GET /twiki/bin/rdiff/TWiki/PeterFokkinga?rev1=1.4&rev2=1.3 HTTP/1.1\" 200 4548"],["2016-11-20T10:30:40.590Z acer4520 64.242.88.10 - - [07/Mar/2004:18:32:39 -0800] \"GET /mailman/listinfo/dentalstudies HTTP/1.1\" 200 6345"],["2016-11-20T10:30:40.591Z acer4520 64.242.88.10 - - [07/Mar/2004:18:34:42 -0800] \"GET /twiki/bin/view/Main/TWikiGuest HTTP/1.1\" 200 4449"],["2016-11-20T10:30:40.592Z acer4520 64.242.88.10 - - [07/Mar/2004:18:42:29 -0800] \"GET /twiki/bin/attach/Main/TWikiGroups HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.592Z acer4520 64.242.88.10 - - [07/Mar/2004:18:46:00 -0800] \"GET /twiki/bin/rdiff/TWiki/TextFormattingRules?rev1=1.36&rev2=1.35 HTTP/1.1\" 200 25416"],["2016-11-20T10:30:40.593Z acer4520 64.242.88.10 - - [07/Mar/2004:18:47:06 -0800] \"GET /twiki/bin/rdiff/Main/TWikiGroups?rev1=1.3&rev2=1.2 HTTP/1.1\" 200 4308"],["2016-11-20T10:30:40.593Z acer4520 64.242.88.10 - - [07/Mar/2004:18:48:15 -0800] \"GET /twiki/bin/search/TWiki/?scope=topic&regex=on&search=.* HTTP/1.1\" 200 3544"],["2016-11-20T10:30:40.595Z acer4520 64.242.88.10 - - [07/Mar/2004:18:52:30 -0800] \"GET /twiki/bin/edit/Main/Trigger_timeout?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.595Z acer4520 64.242.88.10 - - [07/Mar/2004:18:53:55 -0800] \"GET /twiki/bin/oops/TWiki/TWikiSite?template=oopsmore&param1=1.21&param2=1.21 HTTP/1.1\" 200 11284"],["2016-11-20T10:30:40.596Z acer4520 64.242.88.10 - - [07/Mar/2004:18:57:07 -0800] \"GET /twiki/bin/view/TWiki/TextFormattingRules?rev=r1.35 HTTP/1.1\" 200 27248"],["2016-11-20T10:30:40.597Z acer4520 64.242.88.10 - - [07/Mar/2004:18:58:52 -0800] \"GET /twiki/bin/edit/Main/Mydestination?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.598Z acer4520 64.242.88.10 - - [07/Mar/2004:18:59:52 -0800] \"GET /mailman/listinfo/fcd HTTP/1.1\" 200 5967"],["2016-11-20T10:30:40.598Z acer4520 64.242.88.10 - - [07/Mar/2004:19:01:48 -0800] \"GET /twiki/bin/rdiff/Main/WebHome?rev1=1.28&rev2=1.27 HTTP/1.1\" 200 3596"],["2016-11-20T10:30:40.599Z acer4520 64.242.88.10 - - [07/Mar/2004:19:03:58 -0800] \"GET /twiki/bin/edit/Main/Message_size_limit?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12846"],["2016-11-20T10:30:40.599Z acer4520 64.242.88.10 - - [07/Mar/2004:19:08:55 -0800] \"GET /twiki/bin/rdiff/TWiki/TWikiHistory HTTP/1.1\" 200 138789"],["2016-11-20T10:30:40.600Z acer4520 64.242.88.10 - - [07/Mar/2004:19:10:13 -0800] \"GET /twiki/bin/search/TWiki/?scope=topic&regex=on&search=^y HTTP/1.1\" 200 3628"],["2016-11-20T10:30:40.601Z acer4520 64.242.88.10 - - [07/Mar/2004:19:15:38 -0800] \"GET /twiki/bin/edit/Main/Smtpd_history_flush_threshold?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12851"],["2016-11-20T10:30:40.601Z acer4520 64.242.88.10 - - [07/Mar/2004:19:16:44 -0800] \"GET /twiki/bin/view/TWiki/TWikiHistory?rev=1.59 HTTP/1.1\" 200 52854"],["2016-11-20T10:30:40.602Z acer4520 64.242.88.10 - - [07/Mar/2004:19:18:05 -0800] \"GET /twiki/bin/edit/Main/Sender_canonical_maps?topicparent=Main.ConfigurationVariables HTTP/1.1\" 401 12851"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"value","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496405045E12,"submitTime":1.480496405045E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{"display_query_3":[{"name":"display_query_3","isActive":false,"sources":[{"description":"FileStreamSource[dbfs:/mnt/apacheLogs]","latestOffset":"#6"}],"sink":{"description":"MemorySink","latestOffset":"[#5]"},"exception":null}]},"nuid":"1fdb6fec-682a-4d17-a36c-c8edb8ff907d"},{"version":"CommandV1","origId":996009626413070,"guid":"1d889c07-72b2-45db-83fe-d22d1a940b1b","subtype":"command","commandType":"auto","position":9.98681640625,"command":"logStream= (\nrrStream.select(#regexp_extract('value', r'^([^\\s]+\\s)', 1).alias('a'),\n                     #regexp_extract('value', r'^(\\w+)', 1).alias('b'),\n                     regexp_extract('value', r'^.*(\\d+\\.\\d+\\.\\d+\\.\\d+)', 1).alias('host'),\n                     #regexp_extract('value', r'.*^([^\\s]+\\s)', 1).alias('host'),\n                     regexp_extract('value', r'^.*\\[(\\d\\d/\\w{3}/\\d{4}:\\d{2}:\\d{2}:\\d{2} -\\d{4})]', 1).alias('time_stamp'),\n                     regexp_extract('value', r'^.*\"\\w+\\s+([^\\s]+)\\s+HTTP.*\"', 1).alias('path'),\n                     regexp_extract('value', r'^.*\"\\s+([^\\s]+)', 1).cast('integer').alias('status'),\n                     regexp_extract('value', r'^.*\\s+(\\d+)$', 1).cast('integer').alias('content_size'))\n)","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496267115E12,"submitTime":1.48049626123E12,"finishTime":1.480496267186E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b04d5f53-31ea-4763-9256-08c1ee724989"},{"version":"CommandV1","origId":996009626413071,"guid":"7d9b47e9-b84a-4635-85fb-1af0813c1f90","subtype":"command","commandType":"auto","position":9.98846435546875,"command":"logStream.dtypes","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"><span class=\"ansired\">Out[</span><span class=\"ansired\">29</span><span class=\"ansired\">]: </span>\n[(&apos;host&apos;, &apos;string&apos;),\n (&apos;time_stamp&apos;, &apos;string&apos;),\n (&apos;path&apos;, &apos;string&apos;),\n (&apos;status&apos;, &apos;int&apos;),\n (&apos;content_size&apos;, &apos;int&apos;)]\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496267195E12,"submitTime":1.480496263677E12,"finishTime":1.480496267218E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9dc3f0c2-1983-4dae-a342-a98f202bb4d0"},{"version":"CommandV1","origId":996009626413072,"guid":"cec368a3-eb56-429e-b761-c2df008f87f1","subtype":"command","commandType":"auto","position":9.989013671875,"command":"display(logStream)\n","commandVersion":0,"state":"finished","results":{"type":"table","data":[["4.242.88.10","07/Mar/2004:16:05:49 -0800","/twiki/bin/edit/Main/Double_bounce_sender?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:16:06:51 -0800","/twiki/bin/rdiff/TWiki/NewUserTemplate?rev1=1.3&rev2=1.2",200.0,4523.0],["4.242.88.10","07/Mar/2004:16:10:02 -0800","/mailman/listinfo/hsdivision",200.0,6291.0],["4.242.88.10","07/Mar/2004:16:11:58 -0800","/twiki/bin/view/TWiki/WikiSyntax",200.0,7352.0],["4.242.88.10","07/Mar/2004:16:20:55 -0800","/twiki/bin/view/Main/DCCAndPostFix",200.0,5253.0],["4.242.88.10","07/Mar/2004:16:23:12 -0800","/twiki/bin/oops/TWiki/AppendixFileSystem?template=oopsmore&param1=1.12&param2=1.12",200.0,11382.0],["4.242.88.10","07/Mar/2004:16:24:16 -0800","/twiki/bin/view/Main/PeterThoeny",200.0,4924.0],["4.242.88.10","07/Mar/2004:16:29:16 -0800","/twiki/bin/edit/Main/Header_checks?topicparent=Main.ConfigurationVariables",401.0,12851.0],["4.242.88.10","07/Mar/2004:16:30:29 -0800","/twiki/bin/attach/Main/OfficeLocations",401.0,12851.0],["4.242.88.10","07/Mar/2004:16:31:48 -0800","/twiki/bin/view/TWiki/WebTopicEditTemplate",200.0,3732.0],["4.242.88.10","07/Mar/2004:16:32:50 -0800","/twiki/bin/view/Main/WebChanges",200.0,40520.0],["4.242.88.10","07/Mar/2004:16:33:53 -0800","/twiki/bin/edit/Main/Smtpd_etrn_restrictions?topicparent=Main.ConfigurationVariables",401.0,12851.0],["4.242.88.10","07/Mar/2004:16:35:19 -0800","/mailman/listinfo/business",200.0,6379.0],["4.242.88.10","07/Mar/2004:16:36:22 -0800","/twiki/bin/rdiff/Main/WebIndex?rev1=1.2&rev2=1.1",200.0,46373.0],["4.242.88.10","07/Mar/2004:16:37:27 -0800","/twiki/bin/view/TWiki/DontNotify",200.0,4140.0],["4.242.88.10","07/Mar/2004:16:39:24 -0800","/twiki/bin/view/Main/TokyoOffice",200.0,3853.0],["4.242.88.10","07/Mar/2004:16:43:54 -0800","/twiki/bin/view/Main/MikeMannix",200.0,3686.0],["4.242.88.10","07/Mar/2004:16:45:56 -0800","/twiki/bin/attach/Main/PostfixCommands",401.0,12846.0],["4.242.88.10","07/Mar/2004:16:47:12 -0800","/robots.txt",200.0,68.0],["4.242.88.10","07/Mar/2004:16:47:46 -0800","/twiki/bin/rdiff/Know/ReadmeFirst?rev1=1.5&rev2=1.4",200.0,5724.0],["4.242.88.10","07/Mar/2004:16:49:04 -0800","/twiki/bin/view/Main/TWikiGroups?rev=1.2",200.0,5162.0],["4.242.88.10","07/Mar/2004:16:50:54 -0800","/twiki/bin/rdiff/Main/ConfigurationVariables",200.0,59679.0],["4.242.88.10","07/Mar/2004:16:52:35 -0800","/twiki/bin/edit/Main/Flush_service_name?topicparent=Main.ConfigurationVariables",401.0,12851.0],["4.242.88.10","07/Mar/2004:16:53:46 -0800","/twiki/bin/rdiff/TWiki/TWikiRegistration",200.0,34395.0],["4.242.88.10","07/Mar/2004:16:54:55 -0800","/twiki/bin/rdiff/Main/NicholasLee",200.0,7235.0],["4.242.88.10","07/Mar/2004:16:56:39 -0800","/twiki/bin/view/Sandbox/WebHome?rev=1.6",200.0,8545.0],["4.242.88.10","07/Mar/2004:16:58:54 -0800","/mailman/listinfo/administration",200.0,6459.0],["","07/Mar/2004:17:01:53 -0800","/razor.html",200.0,2869.0],["4.242.88.10","07/Mar/2004:17:09:01 -0800","/twiki/bin/search/Main/SearchResult?scope=text&regex=on&search=Joris%20*Benschop[^A-Za-z]",200.0,4284.0],["4.242.88.10","07/Mar/2004:17:10:20 -0800","/twiki/bin/oops/TWiki/TextFormattingRules?template=oopsmore&param1=1.37&param2=1.37",200.0,11400.0],["4.242.88.10","07/Mar/2004:17:13:50 -0800","/twiki/bin/edit/TWiki/DefaultPlugin?t=1078688936",401.0,12846.0],["4.242.88.10","07/Mar/2004:17:16:00 -0800","/twiki/bin/search/Main/?scope=topic&regex=on&search=^g",200.0,3675.0],["4.242.88.10","07/Mar/2004:17:17:27 -0800","/twiki/bin/search/TWiki/?scope=topic&regex=on&search=^d",200.0,5773.0],["","07/Mar/2004:17:18:36 -0800","/robots.txt",200.0,68.0],["","07/Mar/2004:17:18:41 -0800","/twiki/bin/view/Main/LondonOffice",200.0,3860.0],["4.242.88.10","07/Mar/2004:17:21:44 -0800","/twiki/bin/attach/TWiki/TablePlugin",401.0,12846.0],["4.242.88.10","07/Mar/2004:17:22:49 -0800","/twiki/bin/view/TWiki/ManagingWebs?rev=1.22",200.0,9310.0],["4.242.88.10","07/Mar/2004:17:23:54 -0800","/twiki/bin/statistics/Main",200.0,808.0],["4.242.88.10","07/Mar/2004:17:26:30 -0800","/twiki/bin/view/TWiki/WikiCulture",200.0,5935.0],["4.242.88.10","07/Mar/2004:17:27:37 -0800","/twiki/bin/edit/Main/WebSearch?t=1078669682",401.0,12846.0],["4.242.88.10","07/Mar/2004:17:28:45 -0800","/twiki/bin/oops/TWiki/ResetPassword?template=oopsmore&param1=1.4&param2=1.4",200.0,11281.0],["4.242.88.10","07/Mar/2004:17:29:59 -0800","/twiki/bin/view/TWiki/ManagingWebs?skin=print",200.0,8806.0],["4.242.88.10","07/Mar/2004:17:31:39 -0800","/twiki/bin/edit/Main/UvscanAndPostFix?topicparent=Main.WebHome",401.0,12846.0],["4.242.88.10","07/Mar/2004:17:35:35 -0800","/twiki/bin/view/TWiki/KlausWriessnegger",200.0,3848.0],["4.242.88.10","07/Mar/2004:17:39:39 -0800","/twiki/bin/view/Main/SpamAssassin",200.0,4081.0],["4.242.88.10","07/Mar/2004:17:42:15 -0800","/twiki/bin/oops/TWiki/RichardDonkin?template=oopsmore&param1=1.2&param2=1.2",200.0,11281.0],["4.242.88.10","07/Mar/2004:17:46:17 -0800","/twiki/bin/rdiff/TWiki/AlWilliams?rev1=1.3&rev2=1.2",200.0,4485.0],["4.242.88.10","07/Mar/2004:17:47:43 -0800","/twiki/bin/rdiff/TWiki/AlWilliams?rev1=1.2&rev2=1.1",200.0,5234.0],["4.242.88.10","07/Mar/2004:17:50:44 -0800","/twiki/bin/view/TWiki/SvenDowideit",200.0,3616.0],["4.242.88.10","07/Mar/2004:17:53:45 -0800","/twiki/bin/search/Main/SearchResult?scope=text&regex=on&search=Office%20*Locations[^A-Za-z]",200.0,7771.0],["4.242.88.10","07/Mar/2004:17:56:54 -0800","/twiki/bin/view/TWiki/TextFormattingRules?rev=r1.31",200.0,23338.0],["4.242.88.10","07/Mar/2004:17:58:00 -0800","/twiki/bin/edit/Main/KevinWGagel?t=1078670331",401.0,12846.0],["4.242.88.10","07/Mar/2004:18:00:09 -0800","/twiki/bin/edit/Main/Virtual_mailbox_lock?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:18:02:10 -0800","/twiki/bin/view/Main/WebPreferences",200.0,8820.0],["4.242.88.10","07/Mar/2004:18:04:05 -0800","/twiki/bin/view/TWiki/WikiWord?rev=1.3",200.0,6816.0],["","07/Mar/2004:18:06:14 -0800","/twiki/bin/oops/Sandbox/WebChanges",200.0,209.0],["4.242.88.10","07/Mar/2004:18:09:00 -0800","/twiki/bin/rdiff/Main/TWikiGuest",200.0,11314.0],["4.242.88.10","07/Mar/2004:18:10:09 -0800","/twiki/bin/edit/TWiki/TWikiVariables?t=1078684115",401.0,12846.0],["","07/Mar/2004:18:10:18 -0800","/pipermail/cncce/2004-January/000001.html",200.0,3095.0],["","07/Mar/2004:18:10:20 -0800","/pipermail/cncce/2004-January/000002.html",200.0,3810.0],["4.242.88.10","07/Mar/2004:18:17:26 -0800","/twiki/bin/rdiff/TWiki/WikiWord?rev1=1.4&rev2=1.3",200.0,6948.0],["4.242.88.10","07/Mar/2004:18:19:01 -0800","/twiki/bin/edit/Main/TWikiPreferences?topicparent=Main.WebHome",401.0,12846.0],["","07/Mar/2004:18:19:16 -0800","/pipermail/cncce/2004-January.txt",200.0,3376.0],["4.242.88.10","07/Mar/2004:18:22:52 -0800","/twiki/bin/search/Main/SearchResult?scope=text&regex=on&search=Web%20*Statistics[^A-Za-z]",200.0,3584.0],["4.242.88.10","07/Mar/2004:18:26:32 -0800","/twiki/bin/rdiff/TWiki/PeterFokkinga?rev1=1.4&rev2=1.3",200.0,4548.0],["4.242.88.10","07/Mar/2004:18:32:39 -0800","/mailman/listinfo/dentalstudies",200.0,6345.0],["4.242.88.10","07/Mar/2004:18:34:42 -0800","/twiki/bin/view/Main/TWikiGuest",200.0,4449.0],["4.242.88.10","07/Mar/2004:18:42:29 -0800","/twiki/bin/attach/Main/TWikiGroups",401.0,12846.0],["4.242.88.10","07/Mar/2004:18:46:00 -0800","/twiki/bin/rdiff/TWiki/TextFormattingRules?rev1=1.36&rev2=1.35",200.0,25416.0],["4.242.88.10","07/Mar/2004:18:47:06 -0800","/twiki/bin/rdiff/Main/TWikiGroups?rev1=1.3&rev2=1.2",200.0,4308.0],["4.242.88.10","07/Mar/2004:18:48:15 -0800","/twiki/bin/search/TWiki/?scope=topic&regex=on&search=.*",200.0,3544.0],["4.242.88.10","07/Mar/2004:18:52:30 -0800","/twiki/bin/edit/Main/Trigger_timeout?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:18:53:55 -0800","/twiki/bin/oops/TWiki/TWikiSite?template=oopsmore&param1=1.21&param2=1.21",200.0,11284.0],["4.242.88.10","07/Mar/2004:18:57:07 -0800","/twiki/bin/view/TWiki/TextFormattingRules?rev=r1.35",200.0,27248.0],["4.242.88.10","07/Mar/2004:18:58:52 -0800","/twiki/bin/edit/Main/Mydestination?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:18:59:52 -0800","/mailman/listinfo/fcd",200.0,5967.0],["4.242.88.10","07/Mar/2004:19:01:48 -0800","/twiki/bin/rdiff/Main/WebHome?rev1=1.28&rev2=1.27",200.0,3596.0],["4.242.88.10","07/Mar/2004:19:03:58 -0800","/twiki/bin/edit/Main/Message_size_limit?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:19:08:55 -0800","/twiki/bin/rdiff/TWiki/TWikiHistory",200.0,138789.0],["4.242.88.10","07/Mar/2004:19:10:13 -0800","/twiki/bin/search/TWiki/?scope=topic&regex=on&search=^y",200.0,3628.0],["4.242.88.10","07/Mar/2004:19:15:38 -0800","/twiki/bin/edit/Main/Smtpd_history_flush_threshold?topicparent=Main.ConfigurationVariables",401.0,12851.0],["4.242.88.10","07/Mar/2004:19:16:44 -0800","/twiki/bin/view/TWiki/TWikiHistory?rev=1.59",200.0,52854.0],["4.242.88.10","07/Mar/2004:19:18:05 -0800","/twiki/bin/edit/Main/Sender_canonical_maps?topicparent=Main.ConfigurationVariables",401.0,12851.0],["4.242.88.10","07/Mar/2004:19:19:19 -0800","/mailman/listinfo/mlc",200.0,6142.0],["4.242.88.10","07/Mar/2004:19:21:01 -0800","/twiki/bin/rdiff/Main/WebChanges",200.0,114241.0],["4.242.88.10","07/Mar/2004:19:22:11 -0800","/twiki/bin/edit/Sandbox/TestTopic5?topicparent=Sandbox.WebHome",401.0,12846.0],["4.242.88.10","07/Mar/2004:19:24:57 -0800","/twiki/bin/view/TWiki/TextFormattingRules?rev=r1.22",200.0,21162.0],["4.242.88.10","07/Mar/2004:19:26:22 -0800","/twiki/bin/search/TWiki/?scope=topic&regex=on&search=^j",200.0,4524.0],["4.242.88.10","07/Mar/2004:19:29:46 -0800","/twiki/bin/oops/TWiki/TWikiVariables?template=oopsmore&param1=1.62&param2=1.62",200.0,11444.0],["4.242.88.10","07/Mar/2004:19:31:25 -0800","/twiki/bin/edit/Main/Lmtp_connect_timeout?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:19:32:45 -0800","/twiki/bin/search/TWiki/?scope=topic&regex=on&search=^q",200.0,2937.0],["4.242.88.10","07/Mar/2004:19:36:14 -0800","/twiki/bin/view/TWiki/ManagingWebs?rev=1.21",200.0,9310.0],["4.242.88.10","07/Mar/2004:19:39:40 -0800","/twiki/bin/edit/Main/Qmqpd_authorized_clients?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:19:41:33 -0800","/twiki/bin/edit/Main/Header_address_token_limit?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:19:42:45 -0800","/twiki/bin/edit/Main/Syslog_name?topicparent=Main.ConfigurationVariables",401.0,12846.0],["","07/Mar/2004:19:47:36 -0800","*",200.0,null],["4.242.88.10","07/Mar/2004:19:49:28 -0800","/twiki/bin/oops/TWiki/TWikiHistory?template=oopsmore&param1=1.61&param2=1.61",200.0,11345.0],["4.242.88.10","07/Mar/2004:19:52:28 -0800","/twiki/bin/view/TWiki/HaroldGottschalk",200.0,3838.0],["4.242.88.10","07/Mar/2004:19:54:33 -0800","/twiki/bin/view/TWiki/DefaultPlugin?rev=1.4",200.0,7298.0],["4.242.88.10","07/Mar/2004:19:55:40 -0800","/twiki/bin/oops/TWiki/WelcomeGuest?template=oopsmore&param1=1.20&param2=1.20",200.0,11266.0],["4.242.88.10","07/Mar/2004:19:56:41 -0800","/twiki/bin/rdiff/Main/WebIndex",200.0,46373.0],["4.242.88.10","07/Mar/2004:19:58:24 -0800","/twiki/bin/rdiff/TWiki/TWikiRegistration?rev1=1.10&rev2=1.9",200.0,3826.0],["4.242.88.10","07/Mar/2004:20:00:06 -0800","/twiki/bin/view/TWiki/TextFormattingRules?rev=r1.21",200.0,20972.0],["4.242.88.10","07/Mar/2004:20:02:13 -0800","/twiki/bin/attach/TWiki/DefaultPlugin",401.0,12846.0],["4.242.88.10","07/Mar/2004:20:03:29 -0800","/twiki/bin/search/Main/?scope=topic&regex=on&search=^p",200.0,7245.0],["","07/Mar/2004:20:04:03 -0800","/twiki/bin/view/Main/SpamAssassinDeleting",200.0,0.0],["4.242.88.10","07/Mar/2004:20:04:35 -0800","/twiki/bin/edit/Main/Smtp_pix_workaround_delay_time?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:20:07:12 -0800","/twiki/bin/edit/Main/Berkeley_db_create_buffer_size?topicparent=Main.ConfigurationVariables",401.0,12851.0],["","07/Mar/2004:20:10:50 -0800","/robots.txt",200.0,68.0],["4.242.88.10","07/Mar/2004:20:11:33 -0800","/twiki/bin/attach/TWiki/TWikiSite",401.0,12846.0],["4.242.88.10","07/Mar/2004:20:12:55 -0800","/twiki/bin/edit/TWiki/TWikiSite?t=1078681794",401.0,12846.0],["4.242.88.10","07/Mar/2004:20:23:35 -0800","/twiki/bin/search/TWiki/SearchResult?scope=text&regex=on&search=Web%20*Statistics[^A-Za-z]",200.0,10118.0],["4.242.88.10","07/Mar/2004:20:25:31 -0800","/twiki/bin/edit/Main/Defer_transports?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:20:31:40 -0800","/twiki/bin/rdiff/TWiki/SearchDoesNotWork",200.0,6738.0],["4.242.88.10","07/Mar/2004:20:35:28 -0800","/twiki/bin/search/Main/SearchResult?scope=text&regex=on&search=TWiki%20*Admin%20*Group[^A-Za-z]",200.0,7311.0],["4.242.88.10","07/Mar/2004:20:38:14 -0800","/twiki/bin/rdiff/TWiki/ChangePassword",200.0,16670.0],["4.242.88.10","07/Mar/2004:20:40:41 -0800","/twiki/bin/rdiff/TWiki/SvenDowideit",200.0,5277.0],["4.242.88.10","07/Mar/2004:20:42:09 -0800","/twiki/bin/rdiff/TWiki/KevinKinnell?rev1=1.5&rev2=1.4",200.0,4982.0],["4.242.88.10","07/Mar/2004:20:44:48 -0800","/twiki/bin/edit/Main/Undisclosed_recipients_header?topicparent=Main.ConfigurationVariables",401.0,12846.0],["4.242.88.10","07/Mar/2004:20:55:43 -0800","/mailman/listinfo/hs_support",200.0,6294.0],["4.242.88.10","07/Mar/2004:20:56:56 -0800","/twiki/bin/view/TWiki/WebTopicList",200.0,14070.0],["4.242.88.10","07/Mar/2004:20:58:27 -0800","/twiki/bin/attach/TWiki/WebPreferences",401.0,12846.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"host","type":"\"string\"","metadata":"{}"},{"name":"time_stamp","type":"\"string\"","metadata":"{}"},{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"status","type":"\"integer\"","metadata":"{}"},{"name":"content_size","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496390484E12,"submitTime":1.480496390484E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{"display_query_2":[{"name":"display_query_2","isActive":false,"sources":[{"description":"FileStreamSource[dbfs:/mnt/apacheLogs]","latestOffset":"#8"}],"sink":{"description":"MemorySink","latestOffset":"[#8]"},"exception":null}]},"nuid":"1e33b00a-5cd1-4643-b498-a0fe3cd44bfb"},{"version":"CommandV1","origId":996009626413073,"guid":"5d616452-8c68-4136-9208-768ce003c540","subtype":"command","commandType":"auto","position":9.98956298828125,"command":"status_to_count_df =(logStream\n                     .groupBy('status')\n                     .count()\n                     .sort('count', ascending= False)\n                   )","commandVersion":0,"state":"finished","results":{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[]},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496267223E12,"submitTime":1.480496266029E12,"finishTime":1.480496267261E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"301f6166-46fe-4ce9-b73d-77bfdd8cc1cb"},{"version":"CommandV1","origId":996009626413074,"guid":"91fdc3cd-354d-4a1a-868c-8dc66113ec8b","subtype":"command","commandType":"auto","position":9.989837646484375,"command":"display(status_to_count_df)","commandVersion":0,"state":"finished","results":{"type":"table","data":[[200.0,268.0],[401.0,74.0],[304.0,1.0],[404.0,1.0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"status","type":"\"integer\"","metadata":"{}"},{"name":"count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null},"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480496268757E12,"submitTime":1.480496268757E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"barChart","width":"660","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{"display_query_1":[{"name":"display_query_1","isActive":false,"sources":[{"description":"FileStreamSource[dbfs:/mnt/apacheLogs]","latestOffset":"#25"}],"sink":{"description":"MemorySink","latestOffset":"[#24]"},"exception":null}]},"nuid":"b5b1ad3a-75b0-4077-8eb0-15d69de24977"},{"version":"CommandV1","origId":996009626413075,"guid":"9cbb8485-221c-4faf-8848-5909079dd8ee","subtype":"command","commandType":"auto","position":9.990386962890625,"command":"#split_df['timestamp']).cast('timestamp').alias('time')).drop('timestamp')\n#fireServiceCallsTsDF = fireServiceCallsDF \\\n  #.withColumn('CallDateTS', unix_timestamp(fireServiceCallsDF['CallDate'], from_pattern1).cast(\"timestamp\")) \\\n  #.drop('CallDate')\n\nfrom_pattern = 'dd/MMM/yyyy hh:mm:ss z'\n#to_pattern2 = 'yyyy-MMM-dd hh:mm:ss aa'\nto_pattern = 'yyyy-MM-dd hh:mm'\n\n\n#logStream= logStream.withColumn('Timestamp', unix_timestamp(logStream['time_stamp'], from_pattern2).cast(\"timestamp\"))\nlogStreamz= logStream.withColumn('Timestamp', from_unixtime(unix_timestamp(logStream['time_stamp'], from_pattern), to_pattern))\n","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731008E12,"submitTime":1.480495731008E12,"finishTime":1.480495950767E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"546b95db-1627-44f1-88ad-1c6ca26666f6"},{"version":"CommandV1","origId":996009626413076,"guid":"3f09aba2-3e02-4d80-85ac-a401e6a8bc7b","subtype":"command","commandType":"auto","position":9.99066162109375,"command":"#trying to fix time_stamp to unix timestamp\ndisplay(logStreamz)","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731013E12,"submitTime":1.480495731013E12,"finishTime":1.480495950768E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"7f9e11d5-f52c-4459-b4be-934e58078417"},{"version":"CommandV1","origId":996009626413077,"guid":"663ddd7b-dd6f-41d4-a8ad-0b0e27dfe0c7","subtype":"command","commandType":"auto","position":9.9912109375,"command":"\"\"\"\nstreamingCountsDF = (                 \n  rrStream\n    .groupBy(\n      \"host\", \n      window(rrStream.timestamp, \"1 hour\"))\n    .count().select(\"host\", date_format(\"window.end\", \"MMM-dd HH:mm\").alias(\"time\"), \"count\").orderBy(\"time\", \"host\")\n  \n  )\n  \"\"\"","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731017E12,"submitTime":1.480495731017E12,"finishTime":1.480495950769E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3dc0331e-0243-49f5-bfba-bcb14f070f5b"},{"version":"CommandV1","origId":996009626413079,"guid":"90fe6ddc-cba2-43c0-b7e9-70672e1237ad","subtype":"command","commandType":"auto","position":9.997802734375,"command":"\"\"\"import urllib2\n\nfor r in ip_add:\n  url = 'http://freegeoip.net/json/' + 'r'\n\n  k= urllib2.urlopen(url).read()\n  print(k)\n\n\"\"\"\n\nipz_df= logs_df.select('host').dropDuplicates()\n\nipz_df.show()\n","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731022E12,"submitTime":1.480495731022E12,"finishTime":1.48049595077E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"9415c7c5-309f-46f8-83b0-e4094b88d0e3"},{"version":"CommandV1","origId":996009626413080,"guid":"e74951de-2f69-4ac8-b94e-3420e8756e86","subtype":"command","commandType":"auto","position":9.99835205078125,"command":"import urllib2\nfrom pyspark.sql import SQLContext, Row\nipz= logs_df.select('host').dropDuplicates().rdd\n\ndef getIP(ip):\n  url = 'http://freegeoip.net/csv/' + ip\n  str = urllib2.urlopen(url).read()\n  cca2 = str.split(\",\")[1]\n  country= str.split(\",\")[2]\n  Lat= str.split(\",\")[8]\n  Long= str.split(\",\")[9]\n  \n  #deeds= [cca2, country, Lat, Long]\n  #deeds= {'cca2': cca2, 'country':country, 'latitude': Lat, 'longitude': Long}\n  return cca2\n\nmappedIPs = ipz.map(lambda x: (x[0], getIP(x[0])))\n\nmappedIPs.take(10)\n\n#ipz.map(lambda x: x[0])","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731026E12,"submitTime":1.480495731026E12,"finishTime":1.480495950771E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"b2c89bd9-3f27-4389-a6cf-2ce077561a3e"},{"version":"CommandV1","origId":996009626413081,"guid":"6a84d886-752c-439d-893c-8be88af732e1","subtype":"command","commandType":"auto","position":9.998489379882812,"command":"\n# mappedIP2: contains the IP address and CCA2 codes\n# The schema is encoded in a string.\nschemaString = \"ip cca2\"\nfields = [StructField(field_name, StringType(), True) for field_name in schemaString.split()]\nschema = StructType(fields)\n\n# Create DataFrame with schema\nmappedIP2 = sqlContext.createDataFrame(mappedIPs, schema)\n\nmappedIP2.show()","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.48049573103E12,"submitTime":1.48049573103E12,"finishTime":1.480495950772E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"1030f05e-20aa-4cf8-9f22-d985d20bc23d"},{"version":"CommandV1","origId":996009626413088,"guid":"4d749070-ecdd-488f-933f-fdf848150c85","subtype":"command","commandType":"auto","position":9.99886703491211,"command":"mappedIP2.groupBy(\"ip\", \"cca2\").count().show()","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731035E12,"submitTime":1.480495731035E12,"finishTime":1.480495950773E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"6385d080-fda0-436b-820f-5019a3774e78"},{"version":"CommandV1","origId":996009626413086,"guid":"50394a0f-358e-406d-a85c-7278d26cac33","subtype":"command","commandType":"auto","position":9.999244689941406,"command":"mappedIP2.registerTempTable(\"jayz\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731039E12,"submitTime":1.480495731039E12,"finishTime":1.480495950773E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"e73af114-b67b-4d69-92e6-5c32ffc415e9"},{"version":"CommandV1","origId":996009626413087,"guid":"01a6874b-1c82-4a31-b118-f7ec730d9013","subtype":"command","commandType":"auto","position":9.999622344970703,"command":"%sql select * from jayz limit 10;","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731043E12,"submitTime":1.480495731043E12,"finishTime":1.480495950774E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"308","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"51600465-b794-419d-93d9-905f3c25b926"},{"version":"CommandV1","origId":996009626413084,"guid":"710a0b95-9cf9-4fbb-a05e-32db5f5544a5","subtype":"command","commandType":"auto","position":10.0,"command":"import urllib2\nfrom pyspark.sql import SQLContext, Row\nfrom pyspark.sql.types import *\n\n# Obtain the unique agents from the accesslog table\nipaddresses = sqlContext.sql(\"select distinct ip1 from accesslog where ip1 is not null\").rdd\n\n# Convert None to Empty String\ndef xstr(s): \n  if s is None: \n    return '' \n  return str(s)\n\n# getCCA2: Obtains two letter country code based on IP address\ndef getCCA2(ip):\n  # Obtain CCA2 code from FreeGeoIP\n  url = 'http://freegeoip.net/csv/' + ip\n  str = urllib2.urlopen(url).read()\n  cca2 = str.split(\",\")[1]\n  \n  # return\n  return cca2\n\n# Loop through distinct IP addresses and obtain two-letter country codes\nmappedIPs = ipaddresses.map(lambda x: (x[0], getCCA2(x[0])))\n\n# mappedIP2: contains the IP address and CCA2 codes\n# The schema is encoded in a string.\nschemaString = \"ip cca2\"\nfields = [StructField(field_name, StringType(), True) for field_name in schemaString.split()]\nschema = StructType(fields)\n\n# Create DataFrame with schema\nmappedIP2 = sqlContext.createDataFrame(mappedIPs, schema)\n\n# Obtain the Country Codes \nfields = sc.textFile(\"/mnt/tardis6/countrycodes/\").map(lambda l: l.split(\",\"))\ncountrycodes = fields.map(lambda x: Row(cn=x[0], cca2=x[1], cca3=x[2]))\n\n# Country Codes DataFrame:\n#   Create DataFrame (inferring schema using reflection)\ncountryCodesDF = sqlContext.createDataFrame(countrycodes)\n\n# Join countrycodes with mappedIPsDF so we can have IP address and three-letter ISO country codes\nmappedIP3 = mappedIP2 \\\n  .join(countryCodesDF, mappedIP2.cca2 == countryCodesDF.cca2, \"left_outer\") \\\n  .select(mappedIP2.ip, mappedIP2.cca2, countryCodesDF.cca3, countryCodesDF.cn)\n  \n# Register the mapping table\nmappedIP3.registerTempTable(\"mappedIP3\")","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731047E12,"submitTime":1.480495731047E12,"finishTime":1.480495950775E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"09048457-ad24-4525-80cf-aa2acf52de11"},{"version":"CommandV1","origId":4047260936920675,"guid":"c4990f1f-cc24-4625-87f0-fa33e630eff1","subtype":"command","commandType":"auto","position":11.0,"command":"%md ![amazon](http://pjlewis-wordpress.s3-eu-west-1.amazonaws.com/wp-content/uploads/2015/09/amazon-web-services-logo.png)","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.480495731052E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"768a7ee6-d31a-48f4-a749-c87012a91267"},{"version":"CommandV1","origId":2078282228847642,"guid":"14b63082-abb4-4b06-89bf-600784fa06f0","subtype":"command","commandType":"auto","position":11.5,"command":"%md spark intergration with kafka 10.\nSee link:https://spark.apache.org/docs/latest/structured-streaming-kafka-integration.html\n","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"error":null,"workflows":[],"startTime":0.0,"submitTime":1.480495731061E12,"finishTime":0.0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"3774d59e-1b91-4235-a2b0-0375eda77ef8"},{"version":"CommandV1","origId":4047260936920676,"guid":"4213d6f3-ad0a-43a4-8c78-b1fae953091e","subtype":"command","commandType":"auto","position":12.0,"command":"\"\"\"\nval kafka = spark.readStream\n  .format(\"kafka\")\n  .option(\"kafka.bootstrap.servers\", \"host:port\")\n  .option(\"subscribe\", \"topic\")\n  .option(\"startingOffsets\", \"latest\")\n  .load()\n  \n  # Subscribe to 1 topic\nds1 = spark\n  .readStream()\n  .format(\"kafka\")\n  .option(\"kafka.bootstrap.servers\", \"host1:port1,host2:port2\")\n  .option(\"subscribe\", \"topic1\")\n  .load()\nds1.selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n\n# Subscribe to multiple topics\nds2 = spark\n  .readStream\n  .format(\"kafka\")\n  .option(\"kafka.bootstrap.servers\", \"host1:port1,host2:port2\")\n  .option(\"subscribe\", \"topic1,topic2\")\n  .load()\nds2.selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n\n# Subscribe to a pattern\nds3 = spark\n  .readStream()\n  .format(\"kafka\")\n  .option(\"kafka.bootstrap.servers\", \"host1:port1,host2:port2\")\n  .option(\"subscribePattern\", \"topic.*\")\n  .load()\nds3.selectExpr(\"CAST(key AS STRING)\", \"CAST(value AS STRING)\")\n\"\"\"","commandVersion":0,"state":"error","results":null,"errorSummary":"Cancelled","error":null,"workflows":[],"startTime":1.480495731072E12,"submitTime":1.480495731072E12,"finishTime":1.480495950776E12,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"iPythonMetadata":null,"streamStates":{},"nuid":"5da9dbb7-6df7-44f8-b8ed-a268a58eb6b8"}],"dashboards":[{"version":"DashboardViewV1","origId":996009626413085,"guid":"51461641-64eb-4f93-aada-8e6b511cf92a","nuid":"f10671fc-3b9f-419c-9298-ca09ddde9850","title":"stream_fyp","width":1024,"layoutOption":{"stack":false,"grid":true},"elements":[{"guid":"205c374c-bb39-4173-ab37-1a4ae33bb4fb","elementType":"command","elementNUID":"1fdb6fec-682a-4d17-a36c-c8edb8ff907d","position":{"width":24,"height":5,"x":0,"y":0,"z":null},"options":{"showTitle":true,"showRunButton":true,"scale":0.0,"autoScaleImg":false,"title":"raw data","titleAlign":"center"}},{"guid":"75de6b4e-f218-4252-9519-d11cba0ac91f","elementType":"command","elementNUID":"b5b1ad3a-75b0-4077-8eb0-15d69de24977","position":{"width":13,"height":6,"x":0,"y":11,"z":null},"options":{"showTitle":true,"showRunButton":true,"scale":0.0,"autoScaleImg":false,"title":"Status Codes","titleAlign":"center"}},{"guid":"9cc96fc7-1ae7-4a00-bc78-8c291acdd42c","elementType":"command","elementNUID":"1e33b00a-5cd1-4643-b498-a0fe3cd44bfb","position":{"width":24,"height":5,"x":0,"y":5,"z":null},"options":{"showTitle":true,"showRunButton":true,"scale":0.0,"autoScaleImg":false,"title":"parsed data","titleAlign":"center"}}],"globalVars":{}},{"version":"DashboardViewV1","origId":4486708019551211,"guid":"443d04e8-15b4-40a8-830e-4bed5642f529","nuid":"e0a9a75d-8fde-410c-9764-5e2f1706474f","title":"batch_fyp","width":800,"layoutOption":{"stack":false,"grid":true},"elements":[{"guid":"43cb1fef-78d8-43c7-ac57-81cd9e2a46b7","elementType":"command","elementNUID":"768a7ee6-d31a-48f4-a749-c87012a91267","position":{"width":10,"height":5,"x":12,"y":22,"z":null},"options":null},{"guid":"6b6d0649-2373-49c6-9ca0-ac9bfdcc5739","elementType":"command","elementNUID":"3b39f103-acb8-43fe-a5ae-e5b1ac887e0c","position":{"width":12,"height":7,"x":12,"y":15,"z":null},"options":{"showTitle":true,"scale":0.0,"autoScaleImg":false,"title":"Day of Month Unique Hosts count","titleAlign":"center"}},{"guid":"819f88e8-8759-4780-a76c-eee3bb792abf","elementType":"command","elementNUID":"94a73dc7-f6a0-40d8-b9ad-d3f74867263c","position":{"width":12,"height":8,"x":12,"y":7,"z":null},"options":{"showTitle":true,"scale":0.0,"autoScaleImg":false,"title":"Top Link Paths","titleAlign":"center"}},{"guid":"b5c2c31d-1b8b-45f1-9211-5d961edd12bd","elementType":"command","elementNUID":"47e949ac-ae4f-4048-a9af-e77d0c9156cb","position":{"width":10,"height":5,"x":2,"y":22,"z":null},"options":null},{"guid":"bc7e526f-9751-4231-bb8f-54b4c5541a28","elementType":"command","elementNUID":"9cc5b05e-e836-4e8a-84d6-750010a6c22c","position":{"width":12,"height":7,"x":0,"y":15,"z":null},"options":{"showTitle":true,"scale":0.0,"autoScaleImg":false,"title":"Distict IP hits","titleAlign":"center"}},{"guid":"da95c445-c652-4785-b89d-680d0908f34e","elementType":"command","elementNUID":"a5d0acfe-3ede-4f32-aa10-84c9d3cac0f1","position":{"width":24,"height":7,"x":0,"y":0,"z":null},"options":null},{"guid":"e8862f6d-2911-48fa-833b-b977eb14d8b0","elementType":"command","elementNUID":"dc150254-700a-488e-ad69-2c0b57315666","position":{"width":12,"height":8,"x":0,"y":7,"z":null},"options":{"showTitle":true,"scale":0.0,"autoScaleImg":false,"title":"Status  Codes","titleAlign":"center"}}],"globalVars":{}},{"version":"DashboardViewV1","origId":4486708019551212,"guid":"da9a7e31-2ce7-46d8-a814-409e76e33cb0","nuid":"f3639158-2178-4df6-939a-1d2972ee7952","title":"Untitled","width":1024,"layoutOption":{"stack":true,"grid":true},"elements":[{"guid":"7855da51-1c7f-473f-af82-bfdbc782995c","elementType":"command","elementNUID":"5b4d3409-3004-45a5-97b9-2eb0d9790cdb","position":null,"options":null}],"globalVars":{}}],"guid":"04367d2e-3969-451b-8c05-e04ea569156c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{}};</script>
<script
 src="https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js"
 onerror="window.mainJsLoadError = true;"></script>
</head>
<body>
  <script>
if (window.mainJsLoadError) {
  var u = 'https://databricks-prod-cloudfront.cloud.databricks.com/static/e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855/js/notebook-main.js';
  var b = document.getElementsByTagName('body')[0];
  var c = document.createElement('div');
  c.innerHTML = ('<h1>Network Error</h1>' +
    '<p><b>Please check your network connection and try again.</b></p>' +
    '<p>Could not load a required resource: ' + u + '</p>');
  c.style.margin = '30px';
  c.style.padding = '20px 50px';
  c.style.backgroundColor = '#f5f5f5';
  c.style.borderRadius = '5px';
  b.appendChild(c);
}
</script>
</body>
</html>
